import{c as Ve,r as s,u as G,a as kt,j as e,b as Pt,P as ee,d as ie,e as Y,f as V,g as At,h as Et,i as K,B as L,C as X,s as T,l as W,k as Ye,m as ce,n as te,o as ne,Z as Tt,S as Rt,p as Dt,q as Lt,t as qt,v as z,w as Ie,U as It,x as Oe,y as Fe,M as Be,z as be,A as ze,E as Ot,D as He,F as Ft,G as Bt,H as zt,I as Ht,J as Mt,L as J,K as Me,N as $t,O as Wt,Q as F}from"./index-CqeKPE8b.js";import{S as Vt,a as Yt,b as Ut,c as Xt,d as Qt}from"./sheet-DtFO9gef.js";import{O as Gt,R as Zt,a as $e}from"./OrderConfirmation-CJmGAC5G.js";import{C as Ue}from"./chevron-left-_58TzeDw.js";import{H as ve}from"./HorizontalScrollContainer-CaghlxXx.js";import{u as Jt}from"./useRecommendations-CoJe07s2.js";import{P as Kt}from"./party-popper-CESEz7fc.js";import{S as Xe}from"./sparkles-jBw6wLpT.js";import{T as er}from"./trash-2-Bzqm09k4.js";import"./index-CUZd22lb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Ve("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=Ve("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);function sr(t,a){return s.useReducer((o,l)=>a[o][l]??o,t)}var we="ScrollArea",[Qe]=Pt(we),[ar,O]=Qe(we),Ge=s.forwardRef((t,a)=>{const{__scopeScrollArea:o,type:l="hover",dir:i,scrollHideDelay:c=600,...u}=t,[d,m]=s.useState(null),[x,f]=s.useState(null),[p,n]=s.useState(null),[g,h]=s.useState(null),[j,S]=s.useState(null),[_,b]=s.useState(0),[P,k]=s.useState(0),[N,I]=s.useState(!1),[B,M]=s.useState(!1),A=G(a,$=>m($)),R=kt(i);return e.jsx(ar,{scope:o,type:l,dir:R,scrollHideDelay:c,scrollArea:d,viewport:x,onViewportChange:f,content:p,onContentChange:n,scrollbarX:g,onScrollbarXChange:h,scrollbarXEnabled:N,onScrollbarXEnabledChange:I,scrollbarY:j,onScrollbarYChange:S,scrollbarYEnabled:B,onScrollbarYEnabledChange:M,onCornerWidthChange:b,onCornerHeightChange:k,children:e.jsx(ee.div,{dir:R,...u,ref:A,style:{position:"relative","--radix-scroll-area-corner-width":_+"px","--radix-scroll-area-corner-height":P+"px",...t.style}})})});Ge.displayName=we;var Ze="ScrollAreaViewport",Je=s.forwardRef((t,a)=>{const{__scopeScrollArea:o,children:l,nonce:i,...c}=t,u=O(Ze,o),d=s.useRef(null),m=G(a,d,u.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),e.jsx(ee.div,{"data-radix-scroll-area-viewport":"",...c,ref:m,style:{overflowX:u.scrollbarXEnabled?"scroll":"hidden",overflowY:u.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:u.onContentChange,style:{minWidth:"100%",display:"table"},children:l})})]})});Je.displayName=Ze;var H="ScrollAreaScrollbar",je=s.forwardRef((t,a)=>{const{forceMount:o,...l}=t,i=O(H,t.__scopeScrollArea),{onScrollbarXEnabledChange:c,onScrollbarYEnabledChange:u}=i,d=t.orientation==="horizontal";return s.useEffect(()=>(d?c(!0):u(!0),()=>{d?c(!1):u(!1)}),[d,c,u]),i.type==="hover"?e.jsx(nr,{...l,ref:a,forceMount:o}):i.type==="scroll"?e.jsx(or,{...l,ref:a,forceMount:o}):i.type==="auto"?e.jsx(Ke,{...l,ref:a,forceMount:o}):i.type==="always"?e.jsx(ye,{...l,ref:a}):null});je.displayName=H;var nr=s.forwardRef((t,a)=>{const{forceMount:o,...l}=t,i=O(H,t.__scopeScrollArea),[c,u]=s.useState(!1);return s.useEffect(()=>{const d=i.scrollArea;let m=0;if(d){const x=()=>{window.clearTimeout(m),u(!0)},f=()=>{m=window.setTimeout(()=>u(!1),i.scrollHideDelay)};return d.addEventListener("pointerenter",x),d.addEventListener("pointerleave",f),()=>{window.clearTimeout(m),d.removeEventListener("pointerenter",x),d.removeEventListener("pointerleave",f)}}},[i.scrollArea,i.scrollHideDelay]),e.jsx(ie,{present:o||c,children:e.jsx(Ke,{"data-state":c?"visible":"hidden",...l,ref:a})})}),or=s.forwardRef((t,a)=>{const{forceMount:o,...l}=t,i=O(H,t.__scopeScrollArea),c=t.orientation==="horizontal",u=ue(()=>m("SCROLL_END"),100),[d,m]=sr("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return s.useEffect(()=>{if(d==="idle"){const x=window.setTimeout(()=>m("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(x)}},[d,i.scrollHideDelay,m]),s.useEffect(()=>{const x=i.viewport,f=c?"scrollLeft":"scrollTop";if(x){let p=x[f];const n=()=>{const g=x[f];p!==g&&(m("SCROLL"),u()),p=g};return x.addEventListener("scroll",n),()=>x.removeEventListener("scroll",n)}},[i.viewport,c,m,u]),e.jsx(ie,{present:o||d!=="hidden",children:e.jsx(ye,{"data-state":d==="hidden"?"hidden":"visible",...l,ref:a,onPointerEnter:Y(t.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:Y(t.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),Ke=s.forwardRef((t,a)=>{const o=O(H,t.__scopeScrollArea),{forceMount:l,...i}=t,[c,u]=s.useState(!1),d=t.orientation==="horizontal",m=ue(()=>{if(o.viewport){const x=o.viewport.offsetWidth<o.viewport.scrollWidth,f=o.viewport.offsetHeight<o.viewport.scrollHeight;u(d?x:f)}},10);return Q(o.viewport,m),Q(o.content,m),e.jsx(ie,{present:l||c,children:e.jsx(ye,{"data-state":c?"visible":"hidden",...i,ref:a})})}),ye=s.forwardRef((t,a)=>{const{orientation:o="vertical",...l}=t,i=O(H,t.__scopeScrollArea),c=s.useRef(null),u=s.useRef(0),[d,m]=s.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),x=at(d.viewport,d.content),f={...l,sizes:d,onSizesChange:m,hasThumb:x>0&&x<1,onThumbChange:n=>c.current=n,onThumbPointerUp:()=>u.current=0,onThumbPointerDown:n=>u.current=n};function p(n,g){return mr(n,u.current,d,g)}return o==="horizontal"?e.jsx(lr,{...f,ref:a,onThumbPositionChange:()=>{if(i.viewport&&c.current){const n=i.viewport.scrollLeft,g=We(n,d,i.dir);c.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:n=>{i.viewport&&(i.viewport.scrollLeft=n)},onDragScroll:n=>{i.viewport&&(i.viewport.scrollLeft=p(n,i.dir))}}):o==="vertical"?e.jsx(ir,{...f,ref:a,onThumbPositionChange:()=>{if(i.viewport&&c.current){const n=i.viewport.scrollTop,g=We(n,d);c.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:n=>{i.viewport&&(i.viewport.scrollTop=n)},onDragScroll:n=>{i.viewport&&(i.viewport.scrollTop=p(n))}}):null}),lr=s.forwardRef((t,a)=>{const{sizes:o,onSizesChange:l,...i}=t,c=O(H,t.__scopeScrollArea),[u,d]=s.useState(),m=s.useRef(null),x=G(a,m,c.onScrollbarXChange);return s.useEffect(()=>{m.current&&d(getComputedStyle(m.current))},[m]),e.jsx(tt,{"data-orientation":"horizontal",...i,ref:x,sizes:o,style:{bottom:0,left:c.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:c.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":de(o)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.x),onDragScroll:f=>t.onDragScroll(f.x),onWheelScroll:(f,p)=>{if(c.viewport){const n=c.viewport.scrollLeft+f.deltaX;t.onWheelScroll(n),ot(n,p)&&f.preventDefault()}},onResize:()=>{m.current&&c.viewport&&u&&l({content:c.viewport.scrollWidth,viewport:c.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:le(u.paddingLeft),paddingEnd:le(u.paddingRight)}})}})}),ir=s.forwardRef((t,a)=>{const{sizes:o,onSizesChange:l,...i}=t,c=O(H,t.__scopeScrollArea),[u,d]=s.useState(),m=s.useRef(null),x=G(a,m,c.onScrollbarYChange);return s.useEffect(()=>{m.current&&d(getComputedStyle(m.current))},[m]),e.jsx(tt,{"data-orientation":"vertical",...i,ref:x,sizes:o,style:{top:0,right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":de(o)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.y),onDragScroll:f=>t.onDragScroll(f.y),onWheelScroll:(f,p)=>{if(c.viewport){const n=c.viewport.scrollTop+f.deltaY;t.onWheelScroll(n),ot(n,p)&&f.preventDefault()}},onResize:()=>{m.current&&c.viewport&&u&&l({content:c.viewport.scrollHeight,viewport:c.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:le(u.paddingTop),paddingEnd:le(u.paddingBottom)}})}})}),[cr,et]=Qe(H),tt=s.forwardRef((t,a)=>{const{__scopeScrollArea:o,sizes:l,hasThumb:i,onThumbChange:c,onThumbPointerUp:u,onThumbPointerDown:d,onThumbPositionChange:m,onDragScroll:x,onWheelScroll:f,onResize:p,...n}=t,g=O(H,o),[h,j]=s.useState(null),S=G(a,A=>j(A)),_=s.useRef(null),b=s.useRef(""),P=g.viewport,k=l.content-l.viewport,N=V(f),I=V(m),B=ue(p,10);function M(A){if(_.current){const R=A.clientX-_.current.left,$=A.clientY-_.current.top;x({x:R,y:$})}}return s.useEffect(()=>{const A=R=>{const $=R.target;(h==null?void 0:h.contains($))&&N(R,k)};return document.addEventListener("wheel",A,{passive:!1}),()=>document.removeEventListener("wheel",A,{passive:!1})},[P,h,k,N]),s.useEffect(I,[l,I]),Q(h,B),Q(g.content,B),e.jsx(cr,{scope:o,scrollbar:h,hasThumb:i,onThumbChange:V(c),onThumbPointerUp:V(u),onThumbPositionChange:I,onThumbPointerDown:V(d),children:e.jsx(ee.div,{...n,ref:S,style:{position:"absolute",...n.style},onPointerDown:Y(t.onPointerDown,A=>{A.button===0&&(A.target.setPointerCapture(A.pointerId),_.current=h.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),M(A))}),onPointerMove:Y(t.onPointerMove,M),onPointerUp:Y(t.onPointerUp,A=>{const R=A.target;R.hasPointerCapture(A.pointerId)&&R.releasePointerCapture(A.pointerId),document.body.style.webkitUserSelect=b.current,g.viewport&&(g.viewport.style.scrollBehavior=""),_.current=null})})})}),oe="ScrollAreaThumb",rt=s.forwardRef((t,a)=>{const{forceMount:o,...l}=t,i=et(oe,t.__scopeScrollArea);return e.jsx(ie,{present:o||i.hasThumb,children:e.jsx(dr,{ref:a,...l})})}),dr=s.forwardRef((t,a)=>{const{__scopeScrollArea:o,style:l,...i}=t,c=O(oe,o),u=et(oe,o),{onThumbPositionChange:d}=u,m=G(a,p=>u.onThumbChange(p)),x=s.useRef(void 0),f=ue(()=>{x.current&&(x.current(),x.current=void 0)},100);return s.useEffect(()=>{const p=c.viewport;if(p){const n=()=>{if(f(),!x.current){const g=hr(p,d);x.current=g,d()}};return d(),p.addEventListener("scroll",n),()=>p.removeEventListener("scroll",n)}},[c.viewport,f,d]),e.jsx(ee.div,{"data-state":u.hasThumb?"visible":"hidden",...i,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...l},onPointerDownCapture:Y(t.onPointerDownCapture,p=>{const g=p.target.getBoundingClientRect(),h=p.clientX-g.left,j=p.clientY-g.top;u.onThumbPointerDown({x:h,y:j})}),onPointerUp:Y(t.onPointerUp,u.onThumbPointerUp)})});rt.displayName=oe;var Ne="ScrollAreaCorner",st=s.forwardRef((t,a)=>{const o=O(Ne,t.__scopeScrollArea),l=!!(o.scrollbarX&&o.scrollbarY);return o.type!=="scroll"&&l?e.jsx(ur,{...t,ref:a}):null});st.displayName=Ne;var ur=s.forwardRef((t,a)=>{const{__scopeScrollArea:o,...l}=t,i=O(Ne,o),[c,u]=s.useState(0),[d,m]=s.useState(0),x=!!(c&&d);return Q(i.scrollbarX,()=>{var p;const f=((p=i.scrollbarX)==null?void 0:p.offsetHeight)||0;i.onCornerHeightChange(f),m(f)}),Q(i.scrollbarY,()=>{var p;const f=((p=i.scrollbarY)==null?void 0:p.offsetWidth)||0;i.onCornerWidthChange(f),u(f)}),x?e.jsx(ee.div,{...l,ref:a,style:{width:c,height:d,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function le(t){return t?parseInt(t,10):0}function at(t,a){const o=t/a;return isNaN(o)?0:o}function de(t){const a=at(t.viewport,t.content),o=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=(t.scrollbar.size-o)*a;return Math.max(l,18)}function mr(t,a,o,l="ltr"){const i=de(o),c=i/2,u=a||c,d=i-u,m=o.scrollbar.paddingStart+u,x=o.scrollbar.size-o.scrollbar.paddingEnd-d,f=o.content-o.viewport,p=l==="ltr"?[0,f]:[f*-1,0];return nt([m,x],p)(t)}function We(t,a,o="ltr"){const l=de(a),i=a.scrollbar.paddingStart+a.scrollbar.paddingEnd,c=a.scrollbar.size-i,u=a.content-a.viewport,d=c-l,m=o==="ltr"?[0,u]:[u*-1,0],x=Et(t,m);return nt([0,u],[0,d])(x)}function nt(t,a){return o=>{if(t[0]===t[1]||a[0]===a[1])return a[0];const l=(a[1]-a[0])/(t[1]-t[0]);return a[0]+l*(o-t[0])}}function ot(t,a){return t>0&&t<a}var hr=(t,a=()=>{})=>{let o={left:t.scrollLeft,top:t.scrollTop},l=0;return function i(){const c={left:t.scrollLeft,top:t.scrollTop},u=o.left!==c.left,d=o.top!==c.top;(u||d)&&a(),o=c,l=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(l)};function ue(t,a){const o=V(t),l=s.useRef(0);return s.useEffect(()=>()=>window.clearTimeout(l.current),[]),s.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(o,a)},[o,a])}function Q(t,a){const o=V(a);At(()=>{let l=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(l),l=window.requestAnimationFrame(o)});return i.observe(t),()=>{window.cancelAnimationFrame(l),i.unobserve(t)}}},[t,o])}var lt=Ge,fr=Je,xr=st;const it=s.forwardRef(({className:t,children:a,...o},l)=>e.jsxs(lt,{ref:l,className:K("relative overflow-hidden",t),...o,children:[e.jsx(fr,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(ct,{}),e.jsx(xr,{})]}));it.displayName=lt.displayName;const ct=s.forwardRef(({className:t,orientation:a="vertical",...o},l)=>e.jsx(je,{ref:l,orientation:a,className:K("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...o,children:e.jsx(rt,{className:"relative flex-1 rounded-full bg-border"})}));ct.displayName=je.displayName;function pr(){const[t,a]=s.useState([]),[o,l]=s.useState(0),i=async()=>{try{const{data:d,error:m}=await T.from("promotional_banners").select("*").eq("is_active",!0).order("display_order",{ascending:!0});d&&!m&&a(d)}catch(d){W.debug("Promotional banners not available",{error:d})}},c=s.useCallback(()=>{l(d=>(d+1)%Math.max(t.length,1))},[t.length]),u=s.useCallback(()=>{l(d=>(d-1+t.length)%Math.max(t.length,1))},[t.length]);return s.useEffect(()=>{i()},[]),s.useEffect(()=>{if(t.length<=1)return;const d=setInterval(c,5e3);return()=>clearInterval(d)},[t.length,c]),t.length===0?null:e.jsxs("div",{className:"relative overflow-hidden rounded-xl mx-4 my-4",children:[e.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${o*100}%)`},children:t.map(d=>e.jsx("div",{className:"min-w-full px-1",children:e.jsxs("div",{className:"rounded-xl p-4 min-h-[80px] flex flex-col justify-center",style:{backgroundColor:d.background_color,color:d.text_color},children:[e.jsx("h3",{className:"font-bold text-lg",children:d.title}),d.subtitle&&e.jsx("p",{className:"text-sm opacity-90",children:d.subtitle})]})},d.id))}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(L,{variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 h-8 w-8 rounded-full bg-white/80 hover:bg-white",onClick:u,children:e.jsx(Ue,{className:"h-4 w-4"})}),e.jsx(L,{variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 rounded-full bg-white/80 hover:bg-white",onClick:c,children:e.jsx(X,{className:"h-4 w-4"})})]}),t.length>1&&e.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1.5",children:t.map((d,m)=>e.jsx("button",{className:`w-2 h-2 rounded-full transition-all ${m===o?"bg-white w-4":"bg-white/50"}`,onClick:()=>l(m)},m))})]})}function gr({onAddToCart:t}){const{user:a}=Ye(),{getItemQuantity:o,updateQuantity:l}=ce(),i=te(),[c,u]=s.useState([]),[d,m]=s.useState(!0),x=s.useCallback(async()=>{if(a){try{const{data:f}=await T.from("orders").select("id").eq("user_id",a.id).order("created_at",{ascending:!1}).limit(10);if(!f||f.length===0){m(!1);return}const p=f.map(j=>j.id),{data:n}=await T.from("order_items").select("product_id").in("order_id",p);if(!n||n.length===0){m(!1);return}const g=[...new Set(n.map(j=>j.product_id))],{data:h}=await T.from("products").select(`
                    id, name, price, mrp, image_url, unit, discount_percent,
                    product_variants!left(id, variant_name, variant_value, variant_unit, price, mrp, is_default)
                `).in("id",g.slice(0,10)).eq("is_active",!0);if(h){const j=h.map(S=>{const _=S.product_variants||[],b=_.find(P=>P.is_default)||_[0]||null;return{...S,default_variant:b}});u(j)}}catch(f){W.error("BuyAgain fetch error",{error:f})}m(!1)}},[a]);return s.useEffect(()=>{a?x():m(!1)},[a,x]),d||!a||c.length===0?null:e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 mb-3",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(rr,{className:"h-5 w-5 text-red-500 fill-red-500"}),"Buy Again"]}),e.jsxs("button",{onClick:()=>i("/orders"),className:"text-primary text-sm font-medium flex items-center gap-1 hover:underline",children:["View Orders ",e.jsx(X,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto px-4 pb-2 scrollbar-hide",style:{scrollbarWidth:"none"},children:c.map(f=>e.jsx("div",{className:"flex-shrink-0 w-[150px]",children:e.jsx(ne,{product:f,onAddToCart:t,cartQuantity:o(f.id,null),onQuantityChange:(p,n)=>l(p,null,n)})},f.id))})]})}function br({categories:t,onCategorySelect:a}){const o=te();return t.length===0?null:e.jsxs("div",{className:"py-4 px-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:"Shop by Category"}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-4",children:t.map(l=>e.jsxs("button",{className:"flex flex-col items-center gap-2 group",onClick:()=>{a(l.id),o(`/shop?category=${l.id}`)},children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full overflow-hidden bg-gradient-to-br from-primary/10 to-primary/5 border-2 border-transparent group-hover:border-primary transition-all shadow-sm group-hover:shadow-md",children:l.image_url?e.jsx("img",{src:l.image_url,alt:l.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx("span",{className:"text-2xl",children:"ðŸ›’"})})}),e.jsx("span",{className:"text-xs text-center font-medium text-muted-foreground group-hover:text-primary transition-colors line-clamp-2 max-w-[70px]",children:l.name})]},l.id))})]})}function vr(){const t=te(),[a,o]=s.useState([]),[l,i]=s.useState(0),[c,u]=s.useState(!0);s.useEffect(()=>{(async()=>{try{const{data:g,error:h}=await T.from("hero_banners").select("*").eq("is_active",!0).order("display_order",{ascending:!0});g&&!h&&o(g)}catch{W.debug("Hero banners not available")}u(!1)})()},[]);const d=s.useCallback(()=>{i(n=>(n+1)%Math.max(a.length,1))},[a.length]),m=s.useCallback(()=>{i(n=>(n-1+a.length)%Math.max(a.length,1))},[a.length]);if(s.useEffect(()=>{if(a.length<=1)return;const n=setInterval(d,5e3);return()=>clearInterval(n)},[a.length,d]),c||a.length===0)return null;const x=n=>{switch(n.background_type){case"gradient":return{background:n.background_value};case"image":return{backgroundImage:`url(${n.background_value})`,backgroundSize:"cover",backgroundPosition:"center"};case"color":return{backgroundColor:n.background_value};default:return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}},f=(n,g)=>{n.stopPropagation(),g&&(g.startsWith("http")?window.open(g,"_blank"):t(g))},p=n=>{if(!(!n.click_type||n.click_type==="none"||!n.click_target))switch(n.click_type){case"category":t(`/shop?category=${n.click_target}`);break;case"product":t(`/product/${n.click_target}`);break;case"url":n.click_target.startsWith("http")?window.open(n.click_target,"_blank"):t(n.click_target);break}};return e.jsxs("div",{className:"relative mx-4 my-4 overflow-hidden rounded-2xl",children:[e.jsx("div",{className:"flex transition-transform duration-500 ease-out",style:{transform:`translateX(-${l*100}%)`},children:a.map(n=>e.jsxs("div",{className:`min-w-full relative ${n.click_type&&n.click_type!=="none"&&n.click_target?"cursor-pointer":""}`,style:{...x(n),minHeight:n.height||"200px",borderRadius:n.border_radius||"16px",color:n.text_color||"#ffffff"},onClick:()=>p(n),children:[e.jsxs("div",{className:`h-full flex flex-col justify-center p-6 ${n.image_position==="right"?"pr-24 md:pr-48":""}`,style:{textAlign:n.text_align},children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-2 leading-tight",children:n.title}),n.subtitle&&e.jsx("p",{className:"text-base md:text-lg opacity-90 mb-2",children:n.subtitle}),n.description&&e.jsx("p",{className:"text-sm opacity-80 mb-4",children:n.description}),n.button_text&&e.jsx("div",{children:e.jsx(L,{onClick:g=>f(g,n.button_link),style:{backgroundColor:n.button_bg_color,color:n.button_text_color},className:"px-6 py-2 rounded-full font-semibold shadow-lg hover:opacity-90 transition-opacity",children:n.button_text})})]}),n.image_url&&n.image_position!=="background"&&e.jsx("img",{src:n.image_url,alt:"",className:`absolute ${n.image_position==="right"?"right-2 top-1/2 -translate-y-1/2 h-4/5 max-w-[40%]":n.image_position==="left"?"left-2 top-1/2 -translate-y-1/2 h-4/5 max-w-[40%]":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 h-4/5"} object-contain`})]},n.id))}),a.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:m,className:"absolute left-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-white/80 hover:bg-white flex items-center justify-center shadow-md transition-colors",children:e.jsx(Ue,{className:"h-5 w-5 text-gray-700"})}),e.jsx("button",{onClick:d,className:"absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-white/80 hover:bg-white flex items-center justify-center shadow-md transition-colors",children:e.jsx(X,{className:"h-5 w-5 text-gray-700"})})]}),a.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-2",children:a.map((n,g)=>e.jsx("button",{onClick:()=>i(g),className:`h-2 rounded-full transition-all ${g===l?"w-6 bg-white":"w-2 bg-white/50 hover:bg-white/70"}`},g))})]})}function wr({onAddToCart:t}){const a=te(),{getItemQuantity:o,updateQuantity:l}=ce(),[i,c]=s.useState([]),[u,d]=s.useState({}),[m,x]=s.useState({}),[f,p]=s.useState(!0),n=s.useCallback(async h=>{var j,S,_;try{let b=T.from("products").select(`
                    id, name, price, mrp, image_url, unit, discount_percent,
                    product_variants!left(price, mrp, variant_name, variant_value, variant_unit, is_default)
                `).eq("is_active",!0);switch(h.filter_type){case"discount":{const k=((j=h.filter_config)==null?void 0:j.min_discount)||0;b=b.gte("discount_percent",k);break}case"category":{const k=((S=h.filter_config)==null?void 0:S.category_ids)||[];k.length>0&&(b=b.in("category_id",k));break}case"manual":{const k=((_=h.filter_config)==null?void 0:_.product_ids)||[];k.length>0&&(b=b.in("id",k));break}}const{data:P}=await b.limit(h.max_products).order("discount_percent",{ascending:!1});if(P)return P.map(k=>{var N,I;return{...k,default_variant:((N=k.product_variants)==null?void 0:N.find(B=>B.is_default))||((I=k.product_variants)==null?void 0:I[0])||null}})}catch(b){W.error("Error fetching deal products",{error:b})}return[]},[]),g=s.useCallback(async()=>{try{const{data:h}=await T.from("flash_deals").select("*").eq("is_active",!0).lte("start_time",new Date().toISOString()).gte("end_time",new Date().toISOString()).order("display_order",{ascending:!0});if(h){const j=h;c(j);const S={};for(const _ of j){const b=await n(_);S[_.id]=b}d(S)}}catch{W.debug("Flash deals not available")}p(!1)},[n]);return s.useEffect(()=>{g()},[g]),s.useEffect(()=>{const h=setInterval(()=>{const j={};i.forEach(S=>{const _=new Date(S.end_time).getTime(),b=Date.now(),P=_-b;if(P>0){const k=Math.floor(P/36e5),N=Math.floor(P%(1e3*60*60)/(1e3*60)),I=Math.floor(P%(1e3*60)/1e3);j[S.id]={h:k,m:N,s:I}}else j[S.id]={h:0,m:0,s:0}}),x(j)},1e3);return()=>clearInterval(h)},[i]),f||i.length===0?null:e.jsx("div",{className:"space-y-6",children:i.map(h=>{const j=u[h.id]||[],S=m[h.id]||{h:0,m:0,s:0};return j.length===0?null:e.jsxs("div",{className:"mx-4",children:[e.jsxs("div",{className:"rounded-t-2xl p-4",style:{backgroundColor:h.background_color,color:h.text_color},children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-5 w-5 fill-current"}),e.jsx("span",{className:"font-bold text-lg",children:h.title}),h.badge_text&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-semibold",style:{backgroundColor:h.badge_color||void 0,color:"#ffffff"},children:h.badge_text})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{children:"Offer ends at"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"px-2 py-1 rounded font-mono font-bold text-sm",style:{backgroundColor:h.timer_bg_color,color:h.timer_text_color},children:String(S.h).padStart(2,"0")}),e.jsx("span",{className:"font-bold",children:":"}),e.jsx("span",{className:"px-2 py-1 rounded font-mono font-bold text-sm",style:{backgroundColor:h.timer_bg_color,color:h.timer_text_color},children:String(S.m).padStart(2,"0")}),e.jsx("span",{className:"font-bold",children:":"}),e.jsx("span",{className:"px-2 py-1 rounded font-mono font-bold text-sm",style:{backgroundColor:h.timer_bg_color,color:h.timer_text_color},children:String(S.s).padStart(2,"0")})]}),e.jsx("span",{className:"text-xs opacity-70",children:"HH : MM : SS"})]})]}),e.jsxs("div",{className:"bg-background rounded-b-2xl border border-t-0 p-3",children:[e.jsx(ve,{className:"gap-3 pb-2",children:j.map(_=>e.jsx("div",{className:"flex-shrink-0 w-[calc((100vw-48px)/3)] min-w-[100px] max-w-[120px]",children:e.jsx(ne,{product:_,onAddToCart:t,cartQuantity:o(_.id,null),onQuantityChange:(b,P)=>l(b,null,P)})},_.id))}),h.show_see_all&&e.jsxs("button",{onClick:()=>a(`/flash-deals/${h.id}`),className:"w-full text-center text-primary font-semibold text-sm py-2 mt-2 flex items-center justify-center gap-1 hover:underline",children:["See all ",e.jsx(X,{className:"h-4 w-4"})]})]})]},h.id)})})}function jr({value:t,onChange:a,onFocus:o,onBlur:l,className:i=""}){const[c,u]=s.useState(["Milk","Bread","Eggs","Fruits","Vegetables"]),[d,m]=s.useState(0),[x,f]=s.useState(!1),[p,n]=s.useState(!1);s.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:b}=await T.from("products").select("name").eq("is_active",!0).limit(20);if(b&&b.length>0){const k=b.map(N=>N.name).sort(()=>Math.random()-.5).slice(0,8);u(k)}}catch{W.debug("Could not fetch product names for animation")}};s.useEffect(()=>{if(p||t.length>0||c.length<=1)return;const b=setInterval(()=>{f(!0),setTimeout(()=>{m(P=>(P+1)%c.length),f(!1)},300)},3e3);return()=>clearInterval(b)},[p,t,c.length]);const h=s.useCallback(()=>{n(!0),o==null||o()},[o]),j=s.useCallback(()=>{n(!1),l==null||l()},[l]),S=c[d]||"products",_=!p&&t.length===0;return e.jsx("div",{className:`relative ${i}`,children:e.jsxs("div",{className:"relative flex items-center bg-muted/60 rounded-xl border border-border/50 overflow-hidden hover:border-primary/30 transition-colors",children:[e.jsx("div",{className:"pl-4 pr-2 flex items-center",children:e.jsx(Rt,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("input",{type:"text",value:t,onChange:b=>a(b.target.value),onFocus:h,onBlur:j,className:"w-full py-3 pr-4 bg-transparent outline-none text-foreground placeholder-transparent",placeholder:"Search..."}),_&&e.jsxs("div",{className:"absolute left-12 top-1/2 -translate-y-1/2 pointer-events-none flex items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Search for "}),e.jsx("div",{className:"overflow-hidden h-6 flex items-center",children:e.jsx("div",{className:`transition-all duration-300 ease-in-out ${x?"transform -translate-y-full opacity-0":"transform translate-y-0 opacity-100"}`,children:e.jsxs("span",{className:"text-foreground font-medium",children:['"',S,'"']})})})]})]})})}function yr({threshold:t=499,className:a}){const{freeDeliveryThreshold:o}=Dt(),{cartTotal:l}=ce(),i=o||t,c=l>=i,u=Math.max(i-l,0),d=Math.min(l/i*100,100);return l===0?null:e.jsx("div",{className:K("fixed bottom-20 left-1/2 -translate-x-1/2 z-40 transition-all duration-300 animate-in slide-in-from-bottom-4",a),children:e.jsxs("div",{className:K("flex items-center gap-3 px-4 py-2.5 rounded-full shadow-lg backdrop-blur-sm",c?"bg-gradient-to-r from-green-600 to-emerald-500 text-white":"bg-gray-900/95 text-white"),children:[e.jsx("div",{className:K("flex items-center justify-center w-8 h-8 rounded-full",c?"bg-white/20":"bg-primary/20"),children:c?e.jsx(Kt,{className:"h-4 w-4 text-white"}):e.jsx(tr,{className:"h-4 w-4 text-primary"})}),e.jsx("div",{className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-semibold text-sm",children:"Free delivery unlocked!"}),e.jsx(Xe,{className:"h-4 w-4 text-yellow-300 animate-pulse"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm",children:["Add ",e.jsxs("span",{className:"font-bold text-primary",children:["â‚¹",u.toFixed(0)]})," more for"]}),e.jsx("span",{className:"font-semibold text-sm text-green-400",children:"FREE delivery"})]})}),!c&&e.jsx("div",{className:"w-12 h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-green-400 rounded-full transition-all duration-500",style:{width:`${d}%`}})})]})})}function qr(){const{user:t,loading:a,signOut:o}=Ye(),{refreshCart:l,addToCart:i,getItemQuantity:c,updateQuantity:u,guestCartItems:d}=ce(),m=te(),[x,f]=Lt(),[p,n]=s.useState([]),g=x.get("category"),[h,j]=s.useState(g),[S,_]=s.useState([]),[b,P]=s.useState([]),k=x.get("search")||"",[N,I]=s.useState(k),[B,M]=s.useState([]),[A,R]=s.useState(!1),[$,Se]=s.useState(!0),[dt,re]=s.useState(!1),[me,_e]=s.useState(""),[se,he]=s.useState("saved"),[ae,ut]=s.useState(""),[fe,mt]=s.useState(""),[ht,ft]=s.useState(""),[xt,pt]=s.useState(""),[Nr,Sr]=s.useState(""),[gt,xe]=s.useState(!1),[pe,Ce]=s.useState(null),[bt,ke]=s.useState(!1),[Pe,vt]=s.useState(null),{recommendedProducts:Ae,trackView:wt}=Jt(),{isAtTop:jt}=qt();s.useEffect(()=>{const w=setTimeout(async()=>{if(N.trim().length<1){M([]),R(!1);return}const{data:v}=await T.from("products").select("id, name, price, mrp, image_url, unit, discount_percent, stock_quantity").ilike("name",`%${N.trim()}%`).eq("is_active",!0).gt("stock_quantity",0).limit(8);v&&v.length>0?(M(v.map(D=>({...D,stock_quantity:D.stock_quantity??0,unit:D.unit||"piece"}))),R(!0)):(M([]),R(!1))},100);return()=>clearTimeout(w)},[N]);const Ee=s.useCallback(async()=>{const{data:r,error:w}=await T.from("categories").select("*").eq("is_active",!0).order("display_order");!w&&r&&n(r),Se(!1)},[]),ge=s.useCallback(async()=>{let r=T.from("products").select("*").eq("is_active",!0);h&&(r=r.eq("category_id",h));const{data:w,error:v}=await r;if(!v&&w){const D=w.map(C=>C.id),{data:y}=await T.from("product_variants").select("*").in("product_id",D).eq("is_default",!0),E=w.map(C=>{const q=(y==null?void 0:y.find(Ct=>Ct.product_id===C.id))||null;return{...C,default_variant:q}});_(E.map(C=>({...C,stock_quantity:C.stock_quantity??0,unit:C.unit||"piece"})))}},[h]),U=s.useCallback(async()=>{if(!t)return;const{data:r,error:w}=await T.from("cart_items").select("*, products(*), product_variants(*)").eq("user_id",t.id);!w&&r&&P(r)},[t]),Te=s.useCallback(async()=>{if(!t)return;const{data:r}=await T.from("profiles").select("address").eq("id",t.id).single();r!=null&&r.address?(_e(r.address),he("saved")):he("new")},[t]);s.useEffect(()=>{const r=x.get("category");j(r)},[x]),s.useEffect(()=>{a||ge()},[h,a,ge]),s.useEffect(()=>{if(a)return;Ee(),t&&(U(),Te());const r=()=>xe(!0);return window.addEventListener("openCart",r),()=>window.removeEventListener("openCart",r)},[t,a,Ee,U,Te]);const Z=async r=>{await i(r,null)?(F.success("Added to cart"),t&&U()):F.error("Failed to add to cart")},Re=async(r,w)=>{if(w<=0){await De(r);return}const v=b.find(q=>q.id===r);if(!v)return;const{data:D,error:y}=await T.from("products").select("stock_quantity, name").eq("id",v.product_id).single();if(y||!D){F.error("Failed to check stock availability");return}const E=D.stock_quantity??0;if(w>E){if(F.error(`Only ${E} ${D.name} available`),E>0&&E!==v.quantity){const{error:q}=await T.from("cart_items").update({quantity:E}).eq("id",r);q||(U(),F.info(`Cart updated to maximum available (${E})`))}return}const{error:C}=await T.from("cart_items").update({quantity:w}).eq("id",r);C||U()},De=async r=>{const{error:w}=await T.from("cart_items").delete().eq("id",r);w||(U(),F.success("Removed from cart"))},yt=()=>{!t||b.length===0||(Ce(null),re(!0))},Nt=async()=>{if(!t)return;const r=pe!==null;if(!r&&b.length===0){F.error("Your cart is empty");return}const w=se==="saved"?me:ae.trim();if(!w){F.error("Please provide a delivery address");return}try{se==="new"&&ae.trim()&&(await T.from("profiles").update({address:ae.trim()}).eq("id",t.id),_e(ae.trim()));const v=r?[{product_id:pe.id,quantity:1,variant_id:null,price:pe.price}]:b.map(C=>{var q;return{product_id:C.product_id,quantity:C.quantity,variant_id:C.variant_id,price:((q=C.product_variants)==null?void 0:q.price)??C.products.price}}),{data:D,error:y}=await T.rpc("place_order_atomic",{p_user_id:t.id,p_delivery_address:w,p_cart_items:v,p_coupon_id:void 0,p_coupon_discount:0});if(y){W.error("Order placement error",{error:y}),F.error("Failed to place order. Please try again.");return}const E=D;if(!E.success){F.error(E.error||"Failed to place order");return}r||(P([]),l()),ge(),re(!1),xe(!1),Ce(null),ut(""),E.order_id&&(vt(E.order_id),ke(!0))}catch(v){W.error("Unexpected order placement error",{error:v}),F.error("An unexpected error occurred. Please try again.")}},Le=S.filter(r=>r.name.toLowerCase().includes(N.toLowerCase())),St=b.reduce((r,w)=>r+w.products.price*w.quantity,0),_t=d.reduce((r,w)=>{const v=S.find(D=>D.id===w.productId);return r+((v==null?void 0:v.price)||0)*w.quantity},0),qe=t?St:_t;return $?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl supports-[backdrop-filter]:bg-background/20 shadow-[0_10px_40px_rgba(15,23,42,0.35)]",children:e.jsx("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-6 w-6 rounded-md"}),e.jsx(z,{className:"h-6 w-32 rounded-md"})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx(z,{className:"h-10 w-full max-w-md mx-auto rounded-md"})}),e.jsx("div",{className:"container mx-auto px-4 pb-4",children:e.jsx("div",{className:"flex gap-2 overflow-hidden",children:[1,2,3,4,5].map(r=>e.jsx(z,{className:"h-9 w-24 rounded-full shrink-0"},r))})}),e.jsx("div",{className:"container mx-auto px-4 pb-8",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[1,2,3,4,5,6,7,8,9,10].map(r=>e.jsxs("div",{className:"rounded-2xl border-2 border-border/40 bg-card overflow-hidden",children:[e.jsx(z,{className:"aspect-square w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(z,{className:"h-4 w-3/4"}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(z,{className:"h-5 w-16"}),e.jsx(z,{className:"h-3 w-10"})]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx(z,{className:"h-8 w-16 rounded-full"}),e.jsx(z,{className:"h-8 w-8 rounded-full"})]})]})]})]},r))})}),e.jsx(Ie,{})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-20",children:[bt&&Pe&&e.jsx(Gt,{orderId:Pe,onClose:()=>ke(!1)}),e.jsx("header",{className:`sticky top-0 z-40 border-b border-border/40 bg-background/95 backdrop-blur-xl supports-[backdrop-filter]:bg-background/80 shadow-sm transition-transform duration-300 ${jt?"translate-y-0":"-translate-y-full"}`,children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/dist/logo.svg",alt:"PremaShop",className:"h-8 w-auto"}),e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"PremaShop"})]}),e.jsx("p",{className:"text-xs text-muted-foreground font-medium ml-8",children:"âš¡ Rapid Delivery in 14 mins"})]}),e.jsx(L,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full bg-primary/10 hover:bg-primary/20",onClick:()=>m(t?"/profile":"/auth"),"aria-label":"View Profile",children:e.jsx(It,{className:"h-5 w-5 text-primary"})})]})})}),e.jsxs(Vt,{open:gt,onOpenChange:xe,children:[e.jsx(Yt,{asChild:!0,children:e.jsx("button",{id:"cart-trigger",className:"hidden"})}),e.jsxs(Ut,{children:[e.jsx(Xt,{children:e.jsx(Qt,{children:"Your Cart"})}),e.jsx(it,{className:"h-[calc(100vh-200px)] mt-4",children:b.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Your cart is empty"}):e.jsx("div",{className:"space-y-4",children:b.map(r=>e.jsx(Oe,{children:e.jsx(Fe,{className:"p-4",children:e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:r.products.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",r.products.price," / ",r.products.unit]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(L,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Re(r.id,r.quantity-1),children:e.jsx(Be,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-8 text-center",children:r.quantity}),e.jsx(L,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Re(r.id,r.quantity+1),children:e.jsx(be,{className:"h-3 w-3"})}),e.jsx(L,{size:"icon",variant:"ghost",className:"h-7 w-7 ml-auto",onClick:()=>De(r.id),children:e.jsx(er,{className:"h-3 w-3"})})]})]})})})},r.id))})}),b.length>0&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-background border-t",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsxs("span",{className:"font-bold text-lg",children:["$",qe.toFixed(2)]})]}),e.jsx(L,{className:"w-full",onClick:yt,children:"Place Order"})]})]})]}),e.jsx("div",{className:"sticky top-0 z-30 bg-background/95 backdrop-blur-xl py-4",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"relative max-w-md mx-auto",children:[e.jsx(jr,{value:N,onChange:r=>{I(r),r.trim().length>=2&&R(!0)},onFocus:()=>{N.trim().length>=2&&B.length>0&&R(!0)},onBlur:()=>{setTimeout(()=>R(!1),200)}}),A&&B.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-card border rounded-lg shadow-lg z-50 max-h-[300px] overflow-y-auto",children:B.map(r=>e.jsxs("button",{className:"w-full flex items-center gap-3 p-3 hover:bg-muted transition-colors text-left",onClick:()=>{m(`/product/${r.id}`),R(!1)},children:[r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-10 h-10 rounded object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded bg-muted flex items-center justify-center",children:e.jsx(ze,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:r.name}),e.jsxs("p",{className:"text-xs text-primary font-semibold",children:["â‚¹",r.price]})]}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground shrink-0"})]},r.id))})]})})}),e.jsx("div",{className:"container mx-auto px-4 pb-4",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:[e.jsx(L,{variant:h===null?"default":"outline",onClick:()=>{j(null),f({})},className:"rounded-full flex-shrink-0",children:"All"}),p.map(r=>e.jsx(L,{variant:h===r.id?"default":"outline",onClick:()=>{j(r.id),f({category:r.id})},className:"rounded-full flex-shrink-0 whitespace-nowrap",children:r.name},r.id))]})}),!N&&!h&&e.jsx(vr,{}),!N&&!h&&e.jsx(wr,{onAddToCart:Z}),!N&&!h&&e.jsx(pr,{}),t&&Ae.length>0&&!N&&!h&&e.jsxs("div",{className:"container mx-auto px-4 pb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-lg",children:e.jsx(Xe,{className:"h-4 w-4 text-white"})}),e.jsx("h2",{className:"text-lg font-bold",children:"For You"})]}),e.jsx(ve,{className:"gap-3",children:Ae.slice(0,8).map(r=>e.jsx("div",{className:"flex-shrink-0 w-[150px]",children:e.jsx(ne,{product:{...r,mrp:r.mrp??null,stock_quantity:r.stock_quantity??void 0},onAddToCart:()=>{wt(r.id),Z(r.id)},cartQuantity:c(r.id,null),onQuantityChange:(w,v)=>u(w,null,v)})},r.id))})]}),!N&&!h&&p.filter(r=>r.shop_section_visible!==!1).map(r=>{const w=S.filter(v=>v.category_id===r.id);return w.length===0?null:e.jsxs("div",{className:"container mx-auto px-4 pb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:r.name}),e.jsxs("button",{onClick:()=>{j(r.id),f({category:r.id})},className:"text-sm text-primary font-medium hover:underline flex items-center gap-1",children:["See all",e.jsx(X,{className:"h-4 w-4"})]})]}),e.jsx(ve,{className:"gap-3",children:w.slice(0,8).map(v=>e.jsx("div",{className:"flex-shrink-0 w-[calc((100vw-48px)/3)] min-w-[100px] max-w-[120px]",children:e.jsx(ne,{product:{id:v.id,name:v.name,price:v.price,mrp:v.mrp??null,image_url:v.image_url,unit:v.unit,discount_percent:v.discount_percent,default_variant:v.default_variant,stock_quantity:v.stock_quantity},onAddToCart:()=>Z(v.id),cartQuantity:c(v.id,null),onQuantityChange:(D,y)=>u(D,null,y)})},v.id))})]},r.id)}),e.jsx("div",{className:"container mx-auto px-4 pb-8",children:Le.length===0?e.jsx(Ot,{title:N?"No products found":"No products in this category",description:N?`No results for "${N}"`:"Try selecting a different category"}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:Le.map(r=>{const w=r.stock_quantity<=0,v=r.stock_quantity>0&&r.stock_quantity<=5,D=r.stock_quantity>5&&r.stock_quantity<=10;return e.jsxs(Oe,{className:`overflow-hidden rounded-2xl border-2 bg-card/90 hover:shadow-xl transition-all relative ${w?"border-destructive/60 bg-destructive/5":v?"border-red-500/60 bg-red-50/50 dark:bg-red-950/20":D?"border-orange-400/60 bg-orange-50/50 dark:bg-orange-950/20":"border-border/40 hover:border-primary/40"}`,children:[(v||D)&&!w&&e.jsx("div",{className:`absolute top-2 right-2 z-10 px-2 py-1 rounded-full text-xs font-bold ${v?"bg-red-500 text-white animate-pulse":"bg-orange-500 text-white"}`,children:v?`Only ${r.stock_quantity} left!`:`${r.stock_quantity} left`}),(()=>{const y=r.default_variant,E=(y==null?void 0:y.price)??r.price,C=(y==null?void 0:y.mrp)??r.mrp,q=C&&C>E?Math.round((C-E)/C*100):r.discount_percent||0;return q>0?e.jsxs("div",{className:"absolute top-2 left-2 z-10 px-2 py-1 rounded-md bg-gradient-to-r from-green-500 to-emerald-600 text-white text-xs font-bold shadow-lg",children:[q,"% OFF"]}):null})(),e.jsxs(Fe,{className:"p-0",children:[e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center cursor-pointer ${w?"opacity-50":""}`,onClick:()=>m(`/product/${r.id}`),children:r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover"}):e.jsx(ze,{className:"h-12 w-12 text-muted-foreground"})}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2 mb-1 cursor-pointer hover:text-primary transition-colors",onClick:()=>m(`/product/${r.id}`),children:r.name}),r.default_variant&&e.jsx("span",{className:"text-[10px] text-muted-foreground block mb-1",children:He(r.default_variant)}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:(()=>{const y=r.default_variant,E=(y==null?void 0:y.price)??r.price,C=(y==null?void 0:y.mrp)??r.mrp,q=y?He(y):r.unit;return C&&C>E?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:["â‚¹",E]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("p",{className:"text-xs text-muted-foreground line-through",children:["â‚¹",C]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["/ ",q]})]})]}):r.discount_percent&&r.discount_percent>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:["â‚¹",Math.round(r.price*(100-r.discount_percent)/100)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("p",{className:"text-xs text-muted-foreground line-through",children:["â‚¹",r.price]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["/ ",r.unit]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:["â‚¹",E]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["/ ",q]})]})})()}),(()=>{const y=c(r.id,null);return y>0?e.jsxs("div",{className:"flex items-center gap-0 rounded-full overflow-hidden border border-primary",children:[e.jsx(L,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none",onClick:()=>u(r.id,null,y-1),children:e.jsx(Be,{className:"h-3 w-3"})}),e.jsx("span",{className:"px-2 font-bold text-sm min-w-[24px] text-center",children:y}),e.jsx(L,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none",onClick:()=>u(r.id,null,y+1),disabled:w,children:e.jsx(be,{className:"h-3 w-3"})})]}):e.jsx(L,{size:"icon",className:`h-9 w-9 rounded-full ${w?"opacity-50":""}`,onClick:()=>Z(r.id),disabled:w,children:e.jsx(be,{className:"h-4 w-4"})})})()]}),w&&e.jsx(Ft,{variant:"destructive",className:"w-full mt-2 justify-center",children:"Out of Stock"}),v&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 font-medium mt-2 text-center",children:"ðŸ”¥ Hurry! Almost sold out"})]})]})]},r.id)})})}),!N&&!h&&e.jsx(gr,{onAddToCart:Z}),!N&&!h&&e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx(br,{categories:p,onCategorySelect:j})}),e.jsx(Bt,{open:dt,onOpenChange:re,children:e.jsxs(zt,{className:"max-w-md",children:[e.jsx(Ht,{children:e.jsx(Mt,{children:"Select Delivery Address"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs(Zt,{value:se,onValueChange:r=>he(r),children:[me&&e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg",children:[e.jsx($e,{value:"saved",id:"saved"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(J,{htmlFor:"saved",className:"font-medium cursor-pointer",children:"Use Saved Address"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:me})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg",children:[e.jsx($e,{value:"new",id:"new"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(J,{htmlFor:"new",className:"font-medium cursor-pointer",children:"Enter New Address"}),se==="new"&&e.jsxs("div",{className:"space-y-4 mt-3",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-sm",children:"Apartment Complex"}),e.jsxs("select",{value:fe,onChange:r=>mt(r.target.value),className:"w-full mt-1.5 p-2 border rounded-md bg-background text-sm",children:[e.jsx("option",{value:"",children:"Select your apartment..."}),e.jsx("option",{value:"VBHC Vaibhava",title:"VBHC Vaibhava, Chandapura-Anekal Road, Bangalore - 562106",children:"VBHC Vaibhava"}),e.jsx("option",{value:"Symphony",title:"Symphony, Chandapura-Anekal Road, Bangalore - 562106",children:"Symphony"})]}),fe&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ðŸ“ ",fe,", Chandapura-Anekal Road, Bangalore - 562106"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-sm",children:"Block/Tower"}),e.jsx(Me,{placeholder:"e.g., 51",value:ht,onChange:r=>ft(r.target.value),className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(J,{className:"text-sm",children:"Room Number"}),e.jsx(Me,{placeholder:"e.g., 603",value:xt,onChange:r=>pt(r.target.value),className:"mt-1.5"})]})]})]})]})]})]})}),e.jsxs($t,{children:[e.jsx(L,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),e.jsx(L,{onClick:Nt,children:"Confirm Order"})]})]})}),e.jsx(Wt,{}),e.jsx(yr,{threshold:499,cartTotal:qe}),e.jsx(Ie,{})]})}export{qr as default};
