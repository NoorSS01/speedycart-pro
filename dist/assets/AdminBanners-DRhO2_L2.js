import{u as L,b as q,r as c,s as x,j as e,f as g,B as l,A as O,n as y,k,m as w,aw as C,D as I,t as M,v as G,w as R,L as o,I as n,x as H,y as i}from"./index-CzqGsn4l.js";import{M as B,A as V}from"./AdminBottomNav-Cj834JeN.js";import{G as W}from"./grip-vertical-C68hDsCO.js";import{P as J}from"./pencil-CKq7Z-Yz.js";import{T as K}from"./trash-2-Gw59I6Fz.js";import"./sheet-u2JDy9wS.js";import"./wallet-VifLp9f-.js";function se(){const{user:j,userRole:v,loading:f}=L(),p=q(),[m,D]=c.useState([]),[S,A]=c.useState(!0),[F,d]=c.useState(!1),[u,b]=c.useState(null),[a,r]=c.useState({title:"",subtitle:"",background_color:"#22c55e",text_color:"#ffffff",is_active:!0}),N=v==="admin"||v==="super_admin";c.useEffect(()=>{if(!f){if(!j||!N){p("/");return}h()}},[j,f,N,p]);const h=async()=>{const{data:s}=await x.from("promotional_banners").select("*").order("display_order",{ascending:!0});s&&D(s),A(!1)},_=()=>{b(null),r({title:"",subtitle:"",background_color:"#22c55e",text_color:"#ffffff",is_active:!0}),d(!0)},T=s=>{b(s),r({title:s.title,subtitle:s.subtitle||"",background_color:s.background_color,text_color:s.text_color,is_active:s.is_active}),d(!0)},z=async()=>{if(!a.title.trim()){i.error("Title is required");return}try{if(u)await x.from("promotional_banners").update({title:a.title,subtitle:a.subtitle||null,background_color:a.background_color,text_color:a.text_color,is_active:a.is_active,updated_at:new Date().toISOString()}).eq("id",u.id),i.success("Banner updated");else{const s=m.length>0?Math.max(...m.map(t=>t.display_order))+1:1;await x.from("promotional_banners").insert({title:a.title,subtitle:a.subtitle||null,background_color:a.background_color,text_color:a.text_color,is_active:a.is_active,display_order:s}),i.success("Banner created")}d(!1),h()}catch{i.error("Failed to save banner")}},E=async s=>{if(confirm("Delete this banner?"))try{await x.from("promotional_banners").delete().eq("id",s),i.success("Banner deleted"),h()}catch{i.error("Failed to delete")}},P=async s=>{try{await x.from("promotional_banners").update({is_active:!s.is_active}).eq("id",s.id),h()}catch{i.error("Failed to update")}};return S?e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center gap-3",children:[e.jsx(g,{className:"h-8 w-8"}),e.jsx(g,{className:"h-6 w-40"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6 space-y-4",children:[1,2,3].map(s=>e.jsx(g,{className:"h-24 rounded-xl"},s))})]}):e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>p("/admin"),children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),e.jsx("h1",{className:"text-lg font-bold",children:"Promotional Banners"})]})]}),e.jsxs(l,{onClick:_,size:"sm",children:[e.jsx(y,{className:"h-4 w-4 mr-1"})," Add Banner"]})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6 space-y-4",children:m.length===0?e.jsx(k,{children:e.jsxs(w,{className:"py-12 text-center",children:[e.jsx(B,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"No promotional banners yet"}),e.jsxs(l,{onClick:_,className:"mt-4",children:[e.jsx(y,{className:"h-4 w-4 mr-2"})," Create First Banner"]})]})}):m.map(s=>e.jsx(k,{className:s.is_active?"":"opacity-50",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(W,{className:"h-5 w-5 text-muted-foreground mt-1 cursor-grab"}),e.jsx("div",{className:"w-16 h-12 rounded flex items-center justify-center text-xs font-bold",style:{backgroundColor:s.background_color,color:s.text_color},children:"Preview"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),s.subtitle&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{checked:s.is_active,onCheckedChange:()=>P(s)}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>T(s),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E(s.id),children:e.jsx(K,{className:"h-4 w-4 text-destructive"})})]})]})})},s.id))}),e.jsx(I,{open:F,onOpenChange:d,children:e.jsxs(M,{children:[e.jsx(G,{children:e.jsx(R,{children:u?"Edit Banner":"Add New Banner"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Title *"}),e.jsx(n,{value:a.title,onChange:s=>r(t=>({...t,title:s.target.value})),placeholder:"e.g., Free Delivery on Water ðŸ’§"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Subtitle"}),e.jsx(n,{value:a.subtitle,onChange:s=>r(t=>({...t,subtitle:s.target.value})),placeholder:"e.g., Order only water products for free delivery!"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Background Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"color",value:a.background_color,onChange:s=>r(t=>({...t,background_color:s.target.value})),className:"w-12 h-10 p-1 cursor-pointer"}),e.jsx(n,{value:a.background_color,onChange:s=>r(t=>({...t,background_color:s.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Text Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"color",value:a.text_color,onChange:s=>r(t=>({...t,text_color:s.target.value})),className:"w-12 h-10 p-1 cursor-pointer"}),e.jsx(n,{value:a.text_color,onChange:s=>r(t=>({...t,text_color:s.target.value}))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Preview"}),e.jsxs("div",{className:"rounded-xl p-4 min-h-[60px]",style:{backgroundColor:a.background_color,color:a.text_color},children:[e.jsx("h3",{className:"font-bold",children:a.title||"Banner Title"}),a.subtitle&&e.jsx("p",{className:"text-sm opacity-90",children:a.subtitle})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{id:"active",checked:a.is_active,onCheckedChange:s=>r(t=>({...t,is_active:s}))}),e.jsx(o,{htmlFor:"active",children:"Active"})]})]}),e.jsxs(H,{children:[e.jsx(l,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(l,{onClick:z,children:u?"Save Changes":"Create Banner"})]})]})}),e.jsx(V,{})]})}export{se as default};
