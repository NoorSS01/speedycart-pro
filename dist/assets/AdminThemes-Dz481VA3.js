import{k as V,aK as G,n as J,r as d,s as m,l as L,j as e,v as w,B as x,T as O,af as Q,x as j,y as f,at as W,z as U,G as X,H as Y,I as Z,J as $,L as n,K as h,aA as ee,aB as ae,aC as se,aD as re,aE as i,N as te,Q as c,aL as le,aM as oe,aN as ne,F as v}from"./index-Cg7UL77a.js";import{A as ce}from"./AdminBottomNav-BHLz8l2e.js";import{P as E}from"./palette-gNPBOVJZ.js";import{T as ie}from"./trash-2-CVbuaKtE.js";import{S as z}from"./sparkles-DVU1NQri.js";import{F as de}from"./flower-2-DVFrG9Lw.js";import"./sheet-LPIwcTPd.js";import"./wallet-BcFujo2b.js";function ve(){const{user:C,userRole:k,loading:T}=V(),{refreshTheme:q}=G(),y=J(),[u,I]=d.useState([]),[_,N]=d.useState(!0),[b,S]=d.useState(null),[M,p]=d.useState(!1),[r,l]=d.useState({name:"",type:"custom",is_active:!1,primary_color:"#3b82f6",secondary_color:"#1e40af",accent_color:"#60a5fa",background_gradient:null,animation_type:null,animation_intensity:"medium",promo_badge_text:null,promo_badge_color:null}),A=k==="admin"||k==="super_admin";d.useEffect(()=>{if(!T){if(!C||!A){y("/");return}g()}},[C,T,A,y]);const g=async()=>{try{const{data:a}=await m.from("themes").select("*").order("type",{ascending:!0}).order("name",{ascending:!0});if(a){const s=a.map(o=>({...o,type:o.type||"seasonal",animation_intensity:o.animation_intensity||"medium",primary_color:o.primary_color||"#000000",secondary_color:o.secondary_color||"#000000",accent_color:o.accent_color||"#000000",is_active:o.is_active??!1}));I(s)}}catch(a){L.error("Failed to fetch themes",{error:a})}N(!1)},R=()=>{l({name:"",type:"custom",is_active:!1,primary_color:"#3b82f6",secondary_color:"#1e40af",accent_color:"#60a5fa",background_gradient:null,animation_type:null,animation_intensity:"medium",promo_badge_text:null,promo_badge_color:null}),p(!0)},H=async()=>{if(!r.name){c.error("Theme name is required");return}try{N(!0);const a={name:r.name,type:"custom",is_active:!1,primary_color:r.primary_color||"#000000",secondary_color:r.secondary_color||"#000000",accent_color:r.accent_color||"#000000",background_gradient:r.background_gradient,animation_type:r.animation_type,animation_intensity:r.animation_intensity||"medium",promo_badge_text:r.promo_badge_text,promo_badge_color:r.promo_badge_color},{error:s}=await m.from("themes").insert([a]);if(s)throw s;c.success("Theme created successfully"),p(!1),g()}catch(a){L.error("Failed to create theme",{error:a}),c.error("Failed to create theme")}finally{N(!1)}},K=async a=>{if(confirm("Are you sure you want to delete this theme?"))try{const{error:s}=await m.from("themes").delete().eq("id",a);if(s)throw s;c.success("Theme deleted"),g()}catch{c.error("Failed to delete theme")}},F=async(a,s)=>{S(a);try{s?(await m.from("themes").update({is_active:!1}).neq("id",a),await m.from("themes").update({is_active:!0}).eq("id",a),c.success("Theme activated")):(await m.from("themes").update({is_active:!1}).eq("id",a),c.success("Theme deactivated")),await g(),await q()}catch{c.error("Failed to update theme")}S(null)},D=a=>{switch(a){case"snowfall":return e.jsx(ne,{className:"h-5 w-5"});case"sparkles":return e.jsx(oe,{className:"h-5 w-5"});case"rain":return e.jsx(le,{className:"h-5 w-5"});case"petals":return e.jsx(de,{className:"h-5 w-5"});case"leaves":return e.jsx(z,{className:"h-5 w-5"});case"confetti":return e.jsx(z,{className:"h-5 w-5"});default:return e.jsx(E,{className:"h-5 w-5"})}},P=a=>{switch(a){case"seasonal":return e.jsx(v,{variant:"secondary",children:"Seasonal"});case"festival":return e.jsx(v,{className:"bg-amber-500",children:"Festival"});case"custom":return e.jsx(v,{variant:"outline",children:"Custom"});default:return e.jsx(v,{variant:"outline",children:a})}};if(_)return e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center gap-3",children:[e.jsx(w,{className:"h-8 w-8"}),e.jsx(w,{className:"h-6 w-40"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6 space-y-4",children:[1,2,3,4].map(a=>e.jsx(w,{className:"h-28 rounded-xl"},a))})]});const t=u.find(a=>a.is_active),B=u.filter(a=>!a.is_active);return e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center gap-3",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>y("/admin"),children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold",children:"Theme Manager"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Professional seasonal themes"})]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[t&&e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-green-500"}),"Currently Active"]}),e.jsx(j,{className:"border-green-500 border-2",children:e.jsxs(f,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white shadow-lg",style:{backgroundColor:t.primary_color},children:D(t.animation_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[P(t.type),t.animation_type&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.animation_type," animation"]})]})]})]}),e.jsx(W,{checked:!0,disabled:b===t.id,onCheckedChange:()=>F(t.id,!1)})]}),t.promo_badge_text&&e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Promo badge:"}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full text-white font-medium",style:{backgroundColor:t.promo_badge_color||t.primary_color},children:t.promo_badge_text})]})]})})]}),!t&&e.jsx(j,{className:"border-dashed",children:e.jsxs(f,{className:"py-8 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"No theme currently active"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Activate a theme below to give your store a seasonal look"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{onClick:()=>R(),children:[e.jsx(U,{className:"h-4 w-4 mr-2"})," Create Custom Theme"]})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold mb-3 text-sm text-muted-foreground",children:["Available Themes (",B.length,")"]}),e.jsx("div",{className:"space-y-3",children:B.map(a=>e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white shadow",style:{backgroundColor:a.primary_color},children:D(a.animation_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:a.name}),e.jsx("div",{className:"flex items-center gap-2 mt-0.5",children:P(a.type)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[a.type==="custom"&&e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>K(a.id),children:e.jsx(ie,{className:"h-4 w-4 text-destructive"})}),e.jsx(x,{size:"sm",variant:"outline",disabled:b===a.id,onClick:()=>F(a.id,!0),children:b===a.id?"Activating...":"Activate"})]})]})})},a.id))})]}),u.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold mb-3 text-sm text-muted-foreground",children:"Color Palettes"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.slice(0,4).map(a=>e.jsxs(j,{className:"overflow-hidden",children:[e.jsxs("div",{className:"h-4 flex",children:[e.jsx("div",{className:"flex-1",style:{backgroundColor:a.primary_color}}),e.jsx("div",{className:"flex-1",style:{backgroundColor:a.secondary_color}}),e.jsx("div",{className:"flex-1",style:{backgroundColor:a.accent_color}})]}),e.jsx(f,{className:"p-2",children:e.jsx("p",{className:"text-xs font-medium truncate",children:a.name})})]},a.id))})]})]}),e.jsx(X,{open:M,onOpenChange:p,children:e.jsxs(Y,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(Z,{children:e.jsx($,{children:"Create Custom Theme"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Theme Name"}),e.jsx(h,{value:r.name,onChange:a=>l(s=>({...s,name:a.target.value})),placeholder:"My Awesome Theme"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:r.primary_color,onChange:a=>l(s=>({...s,primary_color:a.target.value})),className:"h-10 w-14 p-1 rounded cursor-pointer"}),e.jsx(h,{value:r.primary_color,onChange:a=>l(s=>({...s,primary_color:a.target.value})),className:"uppercase"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Secondary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:r.secondary_color,onChange:a=>l(s=>({...s,secondary_color:a.target.value})),className:"h-10 w-14 p-1 rounded cursor-pointer"}),e.jsx(h,{value:r.secondary_color,onChange:a=>l(s=>({...s,secondary_color:a.target.value})),className:"uppercase"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Accent Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:r.accent_color,onChange:a=>l(s=>({...s,accent_color:a.target.value})),className:"h-10 w-14 p-1 rounded cursor-pointer"}),e.jsx(h,{value:r.accent_color,onChange:a=>l(s=>({...s,accent_color:a.target.value})),className:"uppercase"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Animation Effect"}),e.jsxs(ee,{value:r.animation_type||"none",onValueChange:a=>l(s=>({...s,animation_type:a==="none"?null:a})),children:[e.jsx(ae,{children:e.jsx(se,{placeholder:"Select Effect"})}),e.jsxs(re,{children:[e.jsx(i,{value:"none",children:"None"}),e.jsx(i,{value:"snowfall",children:"Snowfall (Winter)"}),e.jsx(i,{value:"rain",children:"Rain (Monsoon)"}),e.jsx(i,{value:"testals",children:"Falling Petals (Spring)"}),e.jsx(i,{value:"leaves",children:"Falling Leaves (Autumn)"}),e.jsx(i,{value:"sparkles",children:"Sparkles (Festive)"}),e.jsx(i,{value:"confetti",children:"Confetti (Celebration)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Promo Badge Text"}),e.jsx(h,{value:r.promo_badge_text||"",onChange:a=>l(s=>({...s,promo_badge_text:a.target.value||null})),placeholder:"SALE"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Badge Color"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"color",value:r.promo_badge_color||"#000000",onChange:a=>l(s=>({...s,promo_badge_color:a.target.value})),className:"h-10 w-14 p-1 rounded cursor-pointer"})})]})]}),e.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-muted/50",children:[e.jsx(n,{className:"mb-2 block",children:"Theme Preview"}),e.jsxs("div",{className:"w-full h-32 rounded-lg relative overflow-hidden flex items-center justify-center text-white font-bold text-xl shadow-lg border-2 border-white/20",style:{backgroundColor:r.primary_color,backgroundImage:r.background_gradient||"none"},children:[e.jsx("div",{className:"absolute top-2 right-2",children:r.promo_badge_text&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:r.promo_badge_color||"#000000"},children:r.promo_badge_text})}),e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{backgroundColor:r.secondary_color},children:"Icon"}),e.jsx("div",{className:"absolute bottom-0 w-full h-1/3",style:{backgroundColor:r.accent_color}})]})]})]}),e.jsxs(te,{children:[e.jsx(x,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(x,{onClick:H,disabled:_,children:_?"Creating...":"Create Theme"})]})]})}),e.jsx(ce,{})]})}export{ve as default};
