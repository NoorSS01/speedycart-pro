import{p as L,u as Y,a as ee,r as o,b as se,s as C,m as D,j as e,S as j,C as x,c as u,B as v,U as te,P as ae,O as re,Q as P,i as _,R as M,y as S,D as A,E as O,V as le,T as de,l as d,Z as R,W as ne,h as ie}from"./index-CWmUW0Oc.js";import{A as z,W as oe}from"./AdminBottomNav-BKUm4YDC.js";import{C as ce}from"./calendar-dM34qfdG.js";import{D as me}from"./dollar-sign-9-FYD48Y.js";import{P as $}from"./package-check-ev62wzby.js";import{B as xe}from"./boxes-b2j2-WXi.js";import{I as ue}from"./image-DF4Z00LZ.js";import{L as he}from"./layers-CKmnqr7G.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=L("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=L("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=L("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),pe=h=>{const a=new Date,r=new Date(a);switch(h){case"today":r.setHours(0,0,0,0);break;case"7days":r.setDate(a.getDate()-7),r.setHours(0,0,0,0);break;case"30days":r.setDate(a.getDate()-30),r.setHours(0,0,0,0);break;case"all":default:return new Date(0)}return r},I={today:"Today","7days":"7 Days","30days":"30 Days",all:"All Time"};function ye(){const{user:h,userRole:a,loading:r}=Y(),t=ee(),[n,k]=o.useState([]),[l,T]=o.useState(!0),[N,q]=o.useState("7days"),[y,F]=o.useState(0),[U,W]=o.useState(!1),[Z,G]=o.useState(""),{deliveryTimeMinutes:Q,updateDeliveryTime:V}=se();o.useEffect(()=>{if(!r){if(!h){t("/auth");return}if(a!==null){if(a!=="admin"&&a!=="super_admin"){switch(a){case"delivery":t("/delivery");break;default:t("/shop");break}return}J()}}},[h,a,r,t,N]);const J=async()=>{T(!0);try{const s=pe(N).toISOString();let p=C.from("orders").select("*").order("created_at",{ascending:!1});N!=="all"&&(p=p.gte("created_at",s));const{data:w,error:b}=await p;if(b)throw b;k(w||[]);const{data:g}=await C.from("delivery_applications").select("status").eq("status","pending");F((g==null?void 0:g.length)||0);try{const{data:c}=await C.from("admin_settings").select("is_locked, payment_message").eq("id","00000000-0000-0000-0000-000000000001").single();c&&(W(c.is_locked||!1),G(c.payment_message||"Payment required to continue using admin panel."))}catch(c){console.log("Lockout check skipped:",c)}}catch(s){console.error("Error fetching data:",s),D.error("Failed to load data")}finally{T(!1)}},i=o.useMemo(()=>{const s=n.filter(m=>m.status==="delivered"),p=n.filter(m=>m.status==="pending"||m.status==="confirmed"||m.status==="out_for_delivery"),w=s.reduce((m,X)=>m+(Number(X.total_amount)||0),0),b=s.length*4,g=s.length*5,c=b+g,K=w-c;return{totalOrders:n.length,pendingOrders:p.length,deliveredOrders:s.length,revenue:w,profit:K,commissionDeveloper:b,commissionDelivery:g}},[n]);return r||a===null?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl shadow-lg",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx(j,{className:"h-8 w-48"})})}),e.jsx("main",{className:"container mx-auto px-4 py-6 space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4].map(s=>e.jsx(j,{className:"h-28 rounded-xl"},s))})}),e.jsx(z,{})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[U&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsx(x,{className:"max-w-md w-full border-red-500 shadow-2xl",children:e.jsxs(u,{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-2",children:"Admin Access Locked"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:Z}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Please complete your payment to continue using the admin dashboard."}),e.jsxs(v,{onClick:()=>t("/admin/to-pay"),className:"w-full",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Go to Payments"]})]})})}),e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl shadow-lg",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full bg-primary/10 hover:bg-primary/20",onClick:()=>t("/admin/profile"),children:e.jsx(te,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg",children:e.jsx(ae,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight",children:"Admin"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Dashboard"})]})]}),e.jsxs(v,{size:"sm",onClick:()=>t("/admin/add-product"),className:"gap-1",children:[e.jsx(re,{className:"w-4 h-4"}),"Add"]})]})})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-muted-foreground shrink-0"}),Object.keys(I).map(s=>e.jsx(v,{variant:N===s?"default":"outline",size:"sm",onClick:()=>q(s),className:"shrink-0",children:I[s]},s))]}),y>0&&e.jsx(x,{className:"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border-amber-200 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/admin/delivery-apps"),children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/40 rounded-xl",children:e.jsx(P,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Delivery Applications"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y," pending review"]})]})]}),e.jsx(_,{className:"bg-amber-500",children:y})]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(f,{title:"Net Profit",value:`₹${i.profit.toLocaleString()}`,icon:oe,color:"emerald",loading:l}),e.jsx(f,{title:"Revenue",value:`₹${i.revenue.toLocaleString()}`,icon:me,color:"blue",loading:l}),e.jsx(f,{title:"Total Orders",value:i.totalOrders.toString(),icon:M,color:"purple",loading:l}),e.jsx(f,{title:"Pending",value:i.pendingOrders.toString(),icon:S,color:"amber",alert:i.pendingOrders>0,loading:l})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(f,{title:"Delivered",value:i.deliveredOrders.toString(),icon:$,color:"emerald",loading:l}),e.jsx(x,{className:"bg-gradient-to-br from-rose-50 to-white dark:from-rose-900/20 dark:to-slate-900 border-rose-100 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/admin/to-pay"),children:e.jsxs(u,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-rose-100 dark:bg-rose-900/40",children:e.jsx(E,{className:"w-5 h-5 text-rose-600"})}),e.jsx(H,{className:"w-4 h-4 text-rose-500"})]}),e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Payments"}),l?e.jsx(j,{className:"h-7 w-20 mt-1"}):e.jsxs("p",{className:"text-2xl font-bold tracking-tight text-rose-600",children:["₹",i.commissionDeveloper+i.commissionDelivery]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Tap to pay →"})]})})]}),e.jsxs(x,{children:[e.jsx(A,{className:"pb-2",children:e.jsxs(O,{className:"text-base flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Admin Tools"]})}),e.jsxs(u,{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>t("/admin/delivery-apps"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-blue-50 to-white dark:from-blue-900/20 dark:to-slate-900 border border-blue-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg",children:e.jsx(de,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Delivery Apps"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Review applications"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/stock"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-emerald-50 to-white dark:from-emerald-900/20 dark:to-slate-900 border border-emerald-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-emerald-100 dark:bg-emerald-900/40 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Products"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Manage inventory"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/banners"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-orange-50 to-white dark:from-orange-900/20 dark:to-slate-900 border border-orange-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/40 rounded-lg",children:e.jsx(B,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Banners"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Promotional offers"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/coupon-triggers"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-yellow-50 to-white dark:from-yellow-900/20 dark:to-slate-900 border border-yellow-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/40 rounded-lg",children:e.jsx(R,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Coupon Triggers"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Automatic discounts"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/hero-banners"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-purple-50 to-white dark:from-purple-900/20 dark:to-slate-900 border border-purple-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:e.jsx(ue,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Hero Banners"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Large homepage banners"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/offer-sections"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-pink-50 to-white dark:from-pink-900/20 dark:to-slate-900 border border-pink-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-pink-100 dark:bg-pink-900/40 rounded-lg",children:e.jsx(he,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Offer Sections"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"50% OFF zones, etc."})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/flash-deals"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-amber-50 to-white dark:from-amber-900/20 dark:to-slate-900 border border-amber-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/40 rounded-lg",children:e.jsx(R,{className:"w-5 h-5 text-amber-600 fill-amber-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Flash Deals"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Time-limited offers"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/security"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-red-50 to-white dark:from-red-900/20 dark:to-slate-900 border border-red-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/40 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Security"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Malicious activity"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>t("/admin/users"),className:"flex items-center gap-3 p-3 bg-gradient-to-br from-purple-50 to-white dark:from-purple-900/20 dark:to-slate-900 border border-purple-100 rounded-xl text-left hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:"Users"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Manage roles"})]}),e.jsx(d,{className:"w-4 h-4 text-muted-foreground"})]})]})]}),e.jsxs(x,{children:[e.jsx(A,{className:"pb-2",children:e.jsxs(O,{className:"text-base flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Delivery Settings"]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Delivery Time Limit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Max time for each delivery"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{className:"border rounded-lg px-3 py-2 text-sm bg-background",value:Q,onChange:async s=>{await V(parseInt(s.target.value))?D.success(`Delivery time set to ${s.target.value} minutes`):D.error("Failed to update delivery time")},children:[e.jsx("option",{value:"15",children:"15 min"}),e.jsx("option",{value:"20",children:"20 min"}),e.jsx("option",{value:"30",children:"30 min"}),e.jsx("option",{value:"45",children:"45 min"}),e.jsx("option",{value:"60",children:"60 min"})]})})]})})]}),e.jsxs(x,{children:[e.jsx(A,{className:"pb-2",children:e.jsxs(O,{className:"text-base flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Recent Orders"]})}),e.jsx(u,{className:"space-y-3",children:l?[1,2,3].map(s=>e.jsx(j,{className:"h-16 rounded-xl"},s)):n.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No orders yet"}):n.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-xl cursor-pointer hover:bg-muted/70 transition-colors",onClick:()=>t("/admin/orders"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white
                      ${s.status==="delivered"?"bg-emerald-500":s.status==="pending"?"bg-amber-500":s.status==="cancelled"?"bg-red-500":"bg-blue-500"}
                    `,children:s.status==="delivered"?e.jsx($,{className:"w-5 h-5"}):s.status==="pending"?e.jsx(S,{className:"w-5 h-5"}):e.jsx(B,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-sm",children:["Order #",s.id.slice(0,8)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ie(new Date(s.created_at),"MMM dd, HH:mm")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["₹",s.total_amount]}),e.jsx(_,{variant:"outline",className:`text-[10px] capitalize
                        ${s.status==="delivered"?"border-emerald-500 text-emerald-600":s.status==="pending"?"border-amber-500 text-amber-600":s.status==="cancelled"?"border-red-500 text-red-600":"border-blue-500 text-blue-600"}
                      `,children:s.status})]})]},s.id))})]})]}),e.jsx(z,{})]})}function f({title:h,value:a,icon:r,color:t,alert:n,loading:k}){const l={emerald:"from-emerald-50 to-white dark:from-emerald-900/20 border-emerald-100 text-emerald-600",blue:"from-blue-50 to-white dark:from-blue-900/20 border-blue-100 text-blue-600",purple:"from-purple-50 to-white dark:from-purple-900/20 border-purple-100 text-purple-600",amber:"from-amber-50 to-white dark:from-amber-900/20 border-amber-100 text-amber-600"};return e.jsx(x,{className:`bg-gradient-to-br ${l[t]} dark:to-slate-900`,children:e.jsxs(u,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`p-2 rounded-xl bg-${t}-100 dark:bg-${t}-900/40`,children:e.jsx(r,{className:`w-5 h-5 text-${t}-600`})}),n&&e.jsxs("span",{className:"flex h-2.5 w-2.5 relative",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-amber-500"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:h}),k?e.jsx(j,{className:"h-7 w-20 mt-1"}):e.jsx("p",{className:"text-2xl font-bold tracking-tight",children:a})]})})}export{ye as default};
