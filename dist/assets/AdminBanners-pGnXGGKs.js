import{u as q,a as L,r as i,s as x,j as e,S as p,B as l,A as O,K as y,C as k,c as C,F as w,$ as I,a0 as M,a1 as G,a2 as R,a3 as H,D as o,I as n,a4 as K,h as c}from"./index-V0QViGkZ.js";import{M as B,A as V}from"./AdminBottomNav-Aaml_i6J.js";import{G as W}from"./grip-vertical-Crw331bS.js";import{P as $}from"./pencil-B6-X1bM1.js";import"./wallet-DZCB4wnd.js";function Z(){const{user:j,userRole:v,loading:f}=q(),g=L(),[u,D]=i.useState([]),[S,A]=i.useState(!0),[F,d]=i.useState(!1),[m,N]=i.useState(null),[a,r]=i.useState({title:"",subtitle:"",background_color:"#22c55e",text_color:"#ffffff",is_active:!0}),_=v==="admin"||v==="super_admin";i.useEffect(()=>{if(!f){if(!j||!_){g("/");return}h()}},[j,f,_,g]);const h=async()=>{const{data:s}=await x.from("promotional_banners").select("*").order("display_order",{ascending:!0});s&&D(s),A(!1)},b=()=>{N(null),r({title:"",subtitle:"",background_color:"#22c55e",text_color:"#ffffff",is_active:!0}),d(!0)},z=s=>{N(s),r({title:s.title,subtitle:s.subtitle||"",background_color:s.background_color,text_color:s.text_color,is_active:s.is_active}),d(!0)},E=async()=>{if(!a.title.trim()){c.error("Title is required");return}try{if(m)await x.from("promotional_banners").update({title:a.title,subtitle:a.subtitle||null,background_color:a.background_color,text_color:a.text_color,is_active:a.is_active,updated_at:new Date().toISOString()}).eq("id",m.id),c.success("Banner updated");else{const s=u.length>0?Math.max(...u.map(t=>t.display_order))+1:1;await x.from("promotional_banners").insert({title:a.title,subtitle:a.subtitle||null,background_color:a.background_color,text_color:a.text_color,is_active:a.is_active,display_order:s}),c.success("Banner created")}d(!1),h()}catch{c.error("Failed to save banner")}},P=async s=>{if(confirm("Delete this banner?"))try{await x.from("promotional_banners").delete().eq("id",s),c.success("Banner deleted"),h()}catch{c.error("Failed to delete")}},T=async s=>{try{await x.from("promotional_banners").update({is_active:!s.is_active}).eq("id",s.id),h()}catch{c.error("Failed to update")}};return S?e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center gap-3",children:[e.jsx(p,{className:"h-8 w-8"}),e.jsx(p,{className:"h-6 w-40"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6 space-y-4",children:[1,2,3].map(s=>e.jsx(p,{className:"h-24 rounded-xl"},s))})]}):e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b bg-background/95 backdrop-blur",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>g("/admin"),children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),e.jsx("h1",{className:"text-lg font-bold",children:"Promotional Banners"})]})]}),e.jsxs(l,{onClick:b,size:"sm",children:[e.jsx(y,{className:"h-4 w-4 mr-1"})," Add Banner"]})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6 space-y-4",children:u.length===0?e.jsx(k,{children:e.jsxs(C,{className:"py-12 text-center",children:[e.jsx(B,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"No promotional banners yet"}),e.jsxs(l,{onClick:b,className:"mt-4",children:[e.jsx(y,{className:"h-4 w-4 mr-2"})," Create First Banner"]})]})}):u.map(s=>e.jsx(k,{className:s.is_active?"":"opacity-50",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(W,{className:"h-5 w-5 text-muted-foreground mt-1 cursor-grab"}),e.jsx("div",{className:"w-16 h-12 rounded flex items-center justify-center text-xs font-bold",style:{backgroundColor:s.background_color,color:s.text_color},children:"Preview"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),s.subtitle&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{checked:s.is_active,onCheckedChange:()=>T(s)}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>z(s),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>P(s.id),children:e.jsx(I,{className:"h-4 w-4 text-destructive"})})]})]})})},s.id))}),e.jsx(M,{open:F,onOpenChange:d,children:e.jsxs(G,{children:[e.jsx(R,{children:e.jsx(H,{children:m?"Edit Banner":"Add New Banner"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Title *"}),e.jsx(n,{value:a.title,onChange:s=>r(t=>({...t,title:s.target.value})),placeholder:"e.g., Free Delivery on Water ðŸ’§"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Subtitle"}),e.jsx(n,{value:a.subtitle,onChange:s=>r(t=>({...t,subtitle:s.target.value})),placeholder:"e.g., Order only water products for free delivery!"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Background Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"color",value:a.background_color,onChange:s=>r(t=>({...t,background_color:s.target.value})),className:"w-12 h-10 p-1 cursor-pointer"}),e.jsx(n,{value:a.background_color,onChange:s=>r(t=>({...t,background_color:s.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Text Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"color",value:a.text_color,onChange:s=>r(t=>({...t,text_color:s.target.value})),className:"w-12 h-10 p-1 cursor-pointer"}),e.jsx(n,{value:a.text_color,onChange:s=>r(t=>({...t,text_color:s.target.value}))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Preview"}),e.jsxs("div",{className:"rounded-xl p-4 min-h-[60px]",style:{backgroundColor:a.background_color,color:a.text_color},children:[e.jsx("h3",{className:"font-bold",children:a.title||"Banner Title"}),a.subtitle&&e.jsx("p",{className:"text-sm opacity-90",children:a.subtitle})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"active",checked:a.is_active,onCheckedChange:s=>r(t=>({...t,is_active:s}))}),e.jsx(o,{htmlFor:"active",children:"Active"})]})]}),e.jsxs(K,{children:[e.jsx(l,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(l,{onClick:E,children:m?"Save Changes":"Create Banner"})]})]})}),e.jsx(V,{})]})}export{Z as default};
