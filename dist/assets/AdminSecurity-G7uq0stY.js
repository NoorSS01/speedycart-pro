import{u as f,a as N,r as c,s as v,n as y,j as e,S as n,B as _,A as w,W as m,C as x,c as u,X as k,i as A,z as C,h as S}from"./index-BPlST4q7.js";import{A as h}from"./AdminBottomNav-W8yJ9IUt.js";import"./wallet-BwAtZGem.js";function E(){const{user:l,userRole:a,loading:t}=f(),r=N(),[i,p]=c.useState([]),[g,o]=c.useState(!0);c.useEffect(()=>{if(!t){if(!l){r("/auth");return}if(a!=="admin"&&a!=="super_admin"){r("/shop");return}j()}},[l,a,t,r]);const j=async()=>{o(!0);const{data:s,error:b}=await v.from("malicious_activities").select("*").order("detected_at",{ascending:!1});b?y.error("Failed to load security reports"):p(s||[]),o(!1)},d=s=>{switch(s.toLowerCase()){case"suspicious_cancellation":return"bg-amber-500";case"fake_delivery":return"bg-red-500";case"fraud":return"bg-red-600";default:return"bg-orange-500"}};return t||a===null?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx(n,{className:"h-8 w-48"})})}),e.jsx("main",{className:"container mx-auto px-4 py-6 space-y-4",children:[1,2,3].map(s=>e.jsx(n,{className:"h-24 rounded-xl"},s))}),e.jsx(h,{})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl shadow-lg",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>r("/admin"),children:e.jsx(w,{className:"h-5 w-5"})}),e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-red-500 to-rose-600 flex items-center justify-center shadow-lg",children:e.jsx(m,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"Security"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.length," activity reports"]})]})]})})}),e.jsx("main",{className:"container mx-auto px-4 py-6 space-y-4",children:g?[1,2,3].map(s=>e.jsx(n,{className:"h-24 rounded-xl"},s)):i.length===0?e.jsx(x,{children:e.jsxs(u,{className:"py-12 text-center",children:[e.jsx(m,{className:"w-12 h-12 mx-auto mb-4 text-emerald-500"}),e.jsx("p",{className:"font-medium text-emerald-600",children:"All Clear!"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No malicious activities detected"})]})}):i.map(s=>e.jsx(x,{className:"border-red-100",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${d(s.activity_type)} bg-opacity-20`,children:e.jsx(k,{className:`w-5 h-5 ${d(s.activity_type).replace("bg-","text-")}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx(A,{className:d(s.activity_type),children:s.activity_type.replace(/_/g," ")}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),S(new Date(s.detected_at),"MMM dd, HH:mm")]})]}),e.jsx("p",{className:"text-sm",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs text-muted-foreground",children:[s.order_id&&e.jsxs("span",{children:["Order: #",s.order_id.slice(0,8)]}),s.user_id&&e.jsxs("span",{children:["User: ",s.user_id.slice(0,8)]}),s.delivery_person_id&&e.jsxs("span",{children:["Delivery: ",s.delivery_person_id.slice(0,8)]})]})]})]})})},s.id))}),e.jsx(h,{})]})}export{E as default};
