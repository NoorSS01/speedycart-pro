import{c as de,r as l,s as u,l as k,z as Ze,b as Ge,u as Ke,a as Je,j as e,h as g,i as qe,o as G,B as F,I as le,X as We,A as Ye,G as Pe,S as Ve,C as es,q as Ae,p as Oe,H as K,M as ss,n as ts,J as Fe,k as ne,K as ie,N as ce,T as as,m as oe,O as rs,Q as ls,U as ns,P as is,D as cs,t as os,v as ds,w as ms,L as z,R as us,x as xs,Z as hs,y as f}from"./index-UMlJGGnY.js";import{O as ps,R as fs,a as Ie}from"./OrderConfirmation-vHSoUW__.js";import{u as gs}from"./useRecommendations-CjsVBZ_s.js";import{C as js}from"./chevron-left-C90EL12Y.js";import{L as ys}from"./leaf-fTEj32U2.js";import"./index-BJvd_s8C.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=de("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=de("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=de("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);function ws(o){const[S,h]=l.useState([]),[J,T]=l.useState(!0),[W,M]=l.useState(null),a=l.useCallback(async()=>{if(!o){T(!1),M(null);return}M(null);try{const{data:q}=await u.from("products").select("id, category_id").eq("id",o).single();if(!q){T(!1);return}const j=[],v=new Set([o]);try{const{data:x}=await u.from("product_co_purchases").select(`
                        product_id,
                        co_product_id,
                        pair_count
                    `).or(`product_id.eq.${o},co_product_id.eq.${o}`).order("pair_count",{ascending:!1}).limit(10);if(x&&x.length>0){const p=x.map(b=>b.product_id===o?b.co_product_id:b.product_id).filter(b=>!v.has(b));if(p.length>0){const{data:b}=await u.from("products").select("*").in("id",p).gt("stock_quantity",0).limit(4);b&&b.forEach(C=>{v.has(C.id)||(j.push(C),v.add(C.id))})}}}catch{}if(j.length<6&&q.category_id){const{data:x}=await u.from("products").select("*").eq("category_id",q.category_id).gt("stock_quantity",0).neq("id",o).order("created_at",{ascending:!1}).limit(4);x&&x.forEach(p=>{!v.has(p.id)&&j.length<8&&(j.push(p),v.add(p.id))})}if(j.length<4){const x=new Date(Date.now()-6048e5).toISOString(),{data:p}=await u.from("order_items").select("product_id").gte("created_at",x);if(p&&p.length>0){const b=p.reduce((m,y)=>(v.has(y.product_id)||(m[y.product_id]=(m[y.product_id]||0)+1),m),{}),C=Object.entries(b).sort((m,y)=>y[1]-m[1]).slice(0,6-j.length).map(([m])=>m);if(C.length>0){const{data:m}=await u.from("products").select("*").in("id",C).gt("stock_quantity",0);m&&m.forEach(y=>{!v.has(y.id)&&j.length<8&&(j.push(y),v.add(y.id))})}}}if(j.length<4){const{data:x}=await u.from("products").select("*").gt("stock_quantity",0).order("created_at",{ascending:!1}).limit(8);x&&x.forEach(p=>{!v.has(p.id)&&j.length<8&&(j.push(p),v.add(p.id))})}h(j)}catch(q){k.error("Frequently bought together error",{error:q}),M("Failed to load recommendations"),h([])}finally{T(!1)}},[o]);return l.useEffect(()=>{a()},[a]),{products:S,isLoading:J,error:W}}function As(){const{id:o}=Ze(),S=Ge(),{user:h}=Ke(),{refreshCart:J,addToCart:T,getItemQuantity:W,updateQuantity:M}=Je(),[a,q]=l.useState(null),[j,v]=l.useState([]),[x,p]=l.useState([]),[b,C]=l.useState(!0),[m,y]=l.useState(1),[$e,D]=l.useState(!1),[Q,Be]=l.useState("address"),[De,U]=l.useState(!1),[I,Y]=l.useState(""),[E,Re]=l.useState("saved"),[R,V]=l.useState(""),[N,me]=l.useState(""),[P,ue]=l.useState(""),[A,xe]=l.useState(""),[ee,Te]=l.useState(!1),[Me,X]=l.useState(!1),[O,H]=l.useState(""),[he,L]=l.useState([]),[pe,fe]=l.useState([]),[n,se]=l.useState(null),[Z,ge]=l.useState([]),[_,$]=l.useState(0),[Ee,je]=l.useState(!1),[Le,ze]=l.useState(""),{trackView:ye}=gs(),{products:Ne}=ws(o);l.useEffect(()=>{const t=setTimeout(async()=>{if(O.trim().length<2){L([]);return}const{data:r}=await u.from("products").select("*").ilike("name",`%${O.trim()}%`).gt("stock_quantity",0).limit(5);r&&L(r.map(c=>({...c,stock_quantity:c.stock_quantity??0,unit:c.unit||"piece"})))},300);return()=>clearTimeout(t)},[O]);const ve=l.useCallback(async(s,t)=>{const{data:r}=await u.from("products").select("*").eq("category_id",s).neq("id",t).gt("stock_quantity",0).limit(6);r&&v(r.map(c=>({...c,stock_quantity:c.stock_quantity??0,unit:c.unit||"piece"})))},[]),te=l.useCallback(async()=>{if(!o)return;const{data:s,error:t}=await u.from("products").select("*").eq("id",o).single();!t&&s&&(q({...s,stock_quantity:s.stock_quantity??0,unit:s.unit||"piece"}),ye(s.id),s.category_id&&ve(s.category_id,s.id)),C(!1)},[o,ye,ve]),be=l.useCallback(async()=>{if(o)try{const{data:s,error:t}=await u.from("product_reviews").select(`
          id,
          rating,
          review_text,
          created_at,
          user_id,
          profiles:user_id(full_name)
        `).eq("product_id",o).order("created_at",{ascending:!1});s&&!t&&p(s)}catch{k.info("Product reviews table may not exist yet")}},[o]),we=l.useCallback(async()=>{if(o)try{const{data:s,error:t}=await u.from("product_images").select("image_url, display_order").eq("product_id",o).order("display_order",{ascending:!0});s&&!t&&ge(s.map(r=>r.image_url))}catch{k.info("Product images table may not exist yet")}},[o]),_e=l.useCallback(async()=>{if(o)try{const{data:s,error:t}=await u.from("product_variants").select("*").eq("product_id",o).order("display_order");if(!t&&s&&s.length>0){fe(s);const r=s.find(c=>c.is_default)||s[0];se(r)}}catch{k.info("Product variants table may not exist yet")}},[o]),Qe=l.useCallback(async()=>{if(!h)return;const{data:s}=await u.from("profiles").select("address").eq("id",h.id).single();s!=null&&s.address&&Y(s.address)},[h]);l.useEffect(()=>{o&&(y(1),fe([]),se(null),ge([]),$(0),q(null),C(!0),te(),be(),_e(),we())},[o,te,be,_e,we]),l.useEffect(()=>{h&&Qe()},[h]);const Ue=async()=>{if(!h||!a){f.error("Please sign in first"),S("/auth");return}if(m>a.stock_quantity){f.error(`Only ${a.stock_quantity} available`);return}D(!0);try{const s=(n==null?void 0:n.id)||null;let t=u.from("cart_items").select("*").eq("user_id",h.id).eq("product_id",a.id);s?t=t.eq("variant_id",s):t=t.is("variant_id",null);const{data:r,error:c}=await t.maybeSingle();if(c){k.error("Cart fetch error",{error:c}),f.error("Failed to check cart. Please try again."),D(!1);return}if(r){const i=r.quantity+m;if(i>a.stock_quantity){f.error(`Only ${a.stock_quantity} available (${r.quantity} already in cart)`),D(!1);return}const{error:d}=await u.from("cart_items").update({quantity:i}).eq("id",r.id);if(d){k.error("Cart update error",{error:d}),f.error("Failed to update cart. Please try again."),D(!1);return}}else{const{error:i}=await u.from("cart_items").insert({user_id:h.id,product_id:a.id,quantity:m,variant_id:s});if(i){k.error("Cart insert error",{error:i}),i.code==="23505"?f.error("This item is already in your cart. Try refreshing the page."):f.error("Failed to add to cart. Please try again."),D(!1);return}}const w=n?` (${n.variant_name})`:"";f.success(`Added ${m}${w} to cart`),J()}catch(s){k.error("Unexpected cart error",{error:s}),f.error("Something went wrong. Please try again.")}finally{D(!1)}},Xe=async()=>{let s="";if(E==="saved")s=I;else if(N&&N!=="Other"){const t=[];P&&t.push(`Block ${P}`),A&&t.push(`Room ${A}`);const r=t.length>0?t.join(", "):"";s=`${r?r+", ":""}${N}, Chandapura-Anekal Road, Bangalore - 562106`}else s=R.trim();if(!s){f.error("Please provide a delivery address");return}if(h){const{error:t}=await u.from("profiles").update({address:s}).eq("id",h.id);if(t){f.error("Failed to save address");return}}Y(s),V(""),me(""),ue(""),xe(""),U(!1),f.success("Delivery address saved")},He=async()=>{if(!h||!a)return;let s="";if(E==="saved")s=I;else if(N&&N!=="Other"){const c=[];P&&c.push(`Block ${P}`),A&&c.push(`Room ${A}`);const w=c.length>0?c.join(", "):"";s=`${w?w+", ":""}${N}, Chandapura-Anekal Road, Bangalore - 562106`}else s=R.trim();if(!s){f.error("Please provide a delivery address");return}const t=(n==null?void 0:n.price)??a.price,r=[{product_id:a.id,variant_id:(n==null?void 0:n.id)||null,quantity:m,price:t}];try{const{data:c,error:w}=await u.rpc("place_order_atomic",{p_user_id:h.id,p_delivery_address:s,p_cart_items:r,p_coupon_id:null,p_coupon_discount:0});if(w){k.error("RPC error",{error:w}),f.error("Failed to place order. Please try again.");return}const i=c;if(!i.success){f.error(i.error||"Failed to place order"),te();return}E==="new"&&R.trim()&&(await u.from("profiles").update({address:R.trim()}).eq("id",h.id),Y(R.trim())),U(!1),V(""),ze(i.order_id||""),je(!0)}catch(c){k.error("Order error",{error:c}),f.error("Failed to place order. Please try again.")}};if(b)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsx(g,{className:"h-9 w-9 rounded-md"}),e.jsx(g,{className:"h-9 w-9 rounded-md"})]})}),e.jsx("div",{className:"w-full aspect-square bg-muted relative",children:e.jsx(g,{className:"w-full h-full"})}),e.jsxs("div",{className:"container mx-auto px-4 py-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"h-8 w-3/4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx(g,{className:"h-8 w-24"}),e.jsx(g,{className:"h-4 w-12"})]}),e.jsx(g,{className:"h-6 w-16 rounded-full"})]})]}),e.jsx(g,{className:"h-20 w-full"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"h-4 w-8"}),e.jsx(g,{className:"h-10 w-32 rounded-full"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(g,{className:"h-12 flex-1 rounded-md"}),e.jsx(g,{className:"h-12 flex-1 rounded-md"})]}),e.jsx(g,{className:"h-40 w-full rounded-xl"}),e.jsx(g,{className:"h-14 w-full rounded-xl"}),e.jsx(g,{className:"h-40 w-full rounded-xl"})]}),e.jsx(qe,{})]});if(!a)return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center gap-4 p-4",children:[e.jsx(G,{className:"h-16 w-16 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Product not found"}),e.jsx(F,{onClick:()=>S("/shop"),children:"Back to Shop"})]});const ae=a.stock_quantity<=0,ke=a.stock_quantity>0&&a.stock_quantity<=5,Ce=x.length>0?(x.reduce((s,t)=>s+t.rating,0)/x.length).toFixed(1):null;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20 pb-24",children:[Ee&&e.jsx(ps,{orderId:Le,onClose:()=>je(!1)}),e.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:Me?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{placeholder:"Search products...",value:O,onChange:s=>H(s.target.value),className:"flex-1",autoFocus:!0,onKeyDown:s=>{s.key==="Enter"&&O.trim()&&S(`/shop?search=${encodeURIComponent(O.trim())}`)}}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>{X(!1),H(""),L([])},children:e.jsx(We,{className:"h-5 w-5"})})]}),he.length>0&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-lg shadow-lg z-50 overflow-hidden",children:[he.map(s=>e.jsxs("button",{onClick:()=>{S(`/product/${s.id}`),X(!1),H(""),L([])},className:"w-full flex items-center gap-3 p-3 hover:bg-muted transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name}),e.jsxs("p",{className:"text-sm text-primary font-semibold",children:["â‚¹",s.price]})]})]},s.id)),e.jsxs("button",{onClick:()=>{S(`/shop?search=${encodeURIComponent(O.trim())}`),X(!1),H(""),L([])},className:"w-full p-3 border-t text-sm text-primary font-medium hover:bg-muted transition-colors",children:['See all results for "',O,'"']})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",onClick:()=>{Be("address"),U(!0)},children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:s=>{s.stopPropagation(),S(-1)},children:e.jsx(Ye,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-muted/50 flex-1 min-w-0 cursor-pointer hover:bg-muted transition-colors",children:[e.jsx(Pe,{className:"h-4 w-4 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-sm truncate",children:I?I.slice(0,30)+(I.length>30?"...":""):"Add delivery address"})]})]}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>X(!0),children:e.jsx(Ve,{className:"h-5 w-5"})})]})})}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"aspect-square bg-muted relative overflow-hidden",onTouchStart:s=>{const t=s.touches[0];s.currentTarget.touchStartX=t.clientX},onTouchEnd:s=>{const t=s.changedTouches[0].clientX,c=(s.currentTarget.touchStartX||0)-t,w=[a.image_url,...Z].filter(Boolean);Math.abs(c)>50&&(c>0&&_<w.length-1?$(_+1):c<0&&_>0&&$(_-1))},children:[(()=>{const t=[a.image_url,...Z].filter(Boolean)[_]||a.image_url;return t?e.jsx("img",{src:t,alt:a.name,className:"w-full h-full object-cover transition-opacity duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"h-24 w-24 text-muted-foreground"})})})(),(()=>{const s=[a.image_url,...Z].filter(Boolean);return s.length>1?e.jsxs(e.Fragment,{children:[_>0&&e.jsx("button",{onClick:()=>$(_-1),className:"absolute left-2 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/30 text-white flex items-center justify-center hover:bg-black/50 transition-colors",children:e.jsx(js,{className:"h-6 w-6"})}),_<s.length-1&&e.jsx("button",{onClick:()=>$(_+1),className:"absolute right-2 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/30 text-white flex items-center justify-center hover:bg-black/50 transition-colors",children:e.jsx(es,{className:"h-6 w-6"})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2",children:s.map((t,r)=>e.jsx("button",{onClick:()=>$(r),className:`w-2.5 h-2.5 rounded-full transition-all ${_===r?"bg-white scale-110":"bg-white/50 hover:bg-white/70"}`},r))})]}):null})(),(()=>{const s=(n==null?void 0:n.mrp)??a.mrp,t=(n==null?void 0:n.price)??a.price,r=s&&s>t?Math.round((s-t)/s*100):0;return r>0?e.jsxs("div",{className:"absolute top-4 left-4 z-10 px-3 py-1.5 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 text-white text-sm font-bold shadow-lg",children:[r,"% OFF"]}):null})(),ke&&e.jsxs(Ae,{className:"absolute top-4 right-4 bg-red-500 text-white",children:["Only ",a.stock_quantity," left!"]}),ae&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsx(Ae,{variant:"destructive",className:"text-lg px-4 py-2",children:"Out of Stock"})})]}),(()=>{const s=[a.image_url,...Z].filter(Boolean);return s.length>1?e.jsx("div",{className:"flex gap-2 p-3 overflow-x-auto bg-muted/50",children:s.map((t,r)=>e.jsx("button",{onClick:()=>$(r),className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ${_===r?"border-primary ring-2 ring-primary/20":"border-transparent opacity-70 hover:opacity-100"}`,children:e.jsx("img",{src:t,alt:`Product ${r+1}`,className:"w-full h-full object-cover"})},r))}):null})()]}),e.jsxs("div",{className:"container mx-auto px-4 py-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:a.name}),pe.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Select Size/Quantity:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:pe.map(s=>{const t=(n==null?void 0:n.id)===s.id,r=s.mrp?Math.round((s.mrp-s.price)/s.mrp*100):0;return e.jsxs("button",{onClick:()=>se(s),className:`relative p-3 rounded-xl border-2 transition-all min-w-[100px] ${t?"border-primary bg-primary/5 shadow-md":"border-border hover:border-primary/50"}`,children:[r>0&&e.jsxs("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:[r,"% OFF"]}),e.jsx("p",{className:"font-semibold text-sm",children:Oe(s)}),e.jsxs("p",{className:"text-primary font-bold",children:["â‚¹",s.price]}),s.mrp&&s.mrp>s.price&&e.jsxs("p",{className:"text-xs text-muted-foreground line-through",children:["â‚¹",s.mrp]})]},s.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex items-baseline gap-2",children:(()=>{const s=(n==null?void 0:n.price)??a.price,t=(n==null?void 0:n.mrp)??a.mrp,r=n?Oe(n):a.unit,c=t?Math.round((t-s)/t*100):0;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-3xl font-bold text-primary",children:["â‚¹",s]}),t&&t>s&&e.jsxs("span",{className:"text-lg text-muted-foreground line-through",children:["â‚¹",t]}),e.jsxs("span",{className:"text-muted-foreground",children:["/ ",r]}),c>0&&!n&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-sm font-semibold rounded",children:[c,"% OFF"]})]})})()}),(()=>{const s=(n==null?void 0:n.price)??a.price;let t=0,r=null;const c=i=>{if(!i)return null;i=i.toLowerCase().trim();const d=i.match(/(\d+\.?\d*)\s*(kg|g|gm|gram|grams|ltr|l|litre|liter|ml|dozen|pack|pcs|pieces)/);return d?{qty:parseFloat(d[1]),unit:d[2]}:null},w=(i,d)=>(d=d.toLowerCase(),d==="kg"?{base:i*1e3,type:"weight"}:["g","gm","gram","grams"].includes(d)?{base:i,type:"weight"}:["l","ltr","litre","liter"].includes(d)?{base:i*1e3,type:"volume"}:d==="ml"?{base:i,type:"volume"}:["dozen","pack","pcs","pieces"].includes(d)?{base:i,type:"count"}:null);if(n){const i=n.variant_name||"",d=(n.variant_unit||"").toLowerCase(),Se=n.variant_value||0;let B=c(i);if(!B&&/^\d+\.?\d*$/.test(i.trim())&&d&&(B={qty:parseFloat(i.trim()),unit:d}),!B&&Se>0&&d&&(B={qty:Se,unit:d}),B){const re=w(B.qty,B.unit);re&&(t=re.base,r=re.type)}}if(!t&&a.unit){const i=c(a.unit);if(i){const d=w(i.qty,i.unit);d&&(t=d.base,r=d.type)}}if(!t||t<=0||!r)return null;if(r==="weight"){const i=s/t*100;return e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["â‚¹",i.toFixed(2)," per 100g"]})}if(r==="volume"){const i=s/t*100;return e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["â‚¹",i.toFixed(2)," per 100ml"]})}if(r==="count"&&t>1){const i=s/t;return e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["â‚¹",i.toFixed(2)," per piece"]})}return null})()]}),Ce&&e.jsxs("div",{className:"flex items-center gap-1 bg-yellow-100 dark:bg-yellow-900/30 px-2 py-1 rounded-full",children:[e.jsx(K,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-bold text-sm",children:Ce}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",x.length,")"]})]})]})]}),a.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:a.description}),!ae&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Qty:"}),e.jsxs("div",{className:"flex items-center gap-2 bg-muted rounded-full p-1",children:[e.jsx(F,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-full",onClick:()=>y(Math.max(1,m-1)),children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-semibold",children:m}),e.jsx(F,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-full",onClick:()=>y(Math.min(a.stock_quantity,m+1)),children:e.jsx(ts,{className:"h-4 w-4"})})]}),ke&&e.jsxs("span",{className:"text-xs text-red-500",children:["Only ",a.stock_quantity," left"]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(F,{className:"flex-1 h-12",onClick:Ue,disabled:ae||$e,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Add to Cart"]})}),e.jsxs(ne,{children:[e.jsx(ie,{className:"py-3 px-4",children:e.jsxs(ce,{className:"text-base flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4 text-primary"})," Highlights"]})}),e.jsx(oe,{className:"px-4 pb-4 pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Brand"}),e.jsx("p",{className:"font-medium",children:"PremasShop"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Type"}),e.jsx("p",{className:"font-medium",children:"Grocery"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ys,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Diet"}),e.jsx("p",{className:"font-medium",children:"Veg"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(bs,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Unit"}),e.jsx("p",{className:"font-medium",children:a.unit})]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(ie,{className:"py-3 px-4 cursor-pointer",onClick:()=>Te(!ee),children:e.jsxs(ce,{className:"text-base flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"h-4 w-4 text-primary"})," Information"]}),ee?e.jsx(rs,{className:"h-4 w-4"}):e.jsx(ls,{className:"h-4 w-4"})]})}),ee&&e.jsxs(oe,{className:"px-4 pb-4 pt-0 space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs mb-1",children:"Disclaimer"}),e.jsx("p",{className:"text-xs leading-relaxed",children:"Images are for representational purposes. Check label for details before consuming."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs mb-1",children:"Customer Care"}),e.jsx("p",{className:"text-xs",children:"support@premasshop.com"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs mb-1",children:"Seller"}),e.jsx("p",{className:"text-xs font-medium",children:"PremasShop Local Vendors"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs mb-1",children:"Country of Origin"}),e.jsx("p",{className:"text-xs",children:"India"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs mb-1",children:"Shelf Life"}),e.jsx("p",{className:"text-xs",children:"As per product packaging"})]})]})]}),e.jsxs(ne,{children:[e.jsx(ie,{className:"py-3 px-4",children:e.jsxs(ce,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-primary"})," Reviews"]})}),e.jsx(oe,{className:"px-4 pb-4 pt-0",children:x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(s=>{var t;return e.jsxs("div",{className:"border-b last:border-0 pb-3 last:pb-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-muted flex items-center justify-center",children:e.jsx(ns,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{className:"text-sm font-medium",children:((t=s.profiles)==null?void 0:t.full_name)||"Anonymous"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[1,2,3,4,5].map(r=>e.jsx(K,{className:`h-3 w-3 ${r<=s.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},r))}),s.review_text&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.review_text})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center py-6 text-center",children:[e.jsx("div",{className:"flex gap-1 mb-2",children:[1,2,3,4,5].map(s=>e.jsx(K,{className:"h-5 w-5 text-muted-foreground/30"},s))}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No reviews yet"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Be the first to review!"})]})})]}),Ne.length>0&&e.jsxs("div",{className:"pt-2",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-primary"}),"Frequently bought together"]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",children:Ne.map(s=>e.jsx("div",{className:"flex-shrink-0 w-[150px]",children:e.jsx(is,{product:{...s,image_url:s.image_url||null,unit:s.unit||"unit",mrp:s.mrp??null,default_variant:null},onAddToCart:t=>T(t,null),cartQuantity:W(s.id,null),onQuantityChange:(t,r)=>M(t,null,r)})},s.id))})]})]}),e.jsx(cs,{open:De,onOpenChange:U,children:e.jsxs(os,{className:"max-w-sm",children:[e.jsx(ds,{children:e.jsxs(ms,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-primary"}),Q==="buynow"?"Confirm Order":"Delivery Address"]})}),e.jsxs("div",{className:"space-y-4",children:[Q==="buynow"&&e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qty: ",m," Ã— â‚¹",a==null?void 0:a.price," = â‚¹",(m*((a==null?void 0:a.price)||0)).toFixed(0)]})]}),e.jsxs(fs,{value:E,onValueChange:s=>Re(s),children:[I&&e.jsxs("div",{className:"flex items-start gap-2 p-3 border rounded-lg",children:[e.jsx(Ie,{value:"saved",id:"saved",className:"mt-1"}),e.jsxs(z,{htmlFor:"saved",className:"flex-1 cursor-pointer",children:[e.jsx("p",{className:"text-sm font-medium",children:"Saved Address"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-wrap break-words",children:I})]})]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 border rounded-lg",children:[e.jsx(Ie,{value:"new",id:"new",className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(z,{htmlFor:"new",className:"cursor-pointer font-medium",children:"New Address"}),E==="new"&&e.jsxs("div",{className:"space-y-3 mt-3",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-xs",children:"Apartment Complex"}),e.jsxs("select",{value:N,onChange:s=>me(s.target.value),className:"w-full mt-1.5 p-2.5 border rounded-md bg-background text-sm",children:[e.jsx("option",{value:"",children:"Select your apartment..."}),e.jsx("option",{value:"VBHC Vaibhava",children:"VBHC Vaibhava"}),e.jsx("option",{value:"Symphony",children:"Symphony"}),e.jsx("option",{value:"Other",children:"Other (Enter manually)"})]}),N&&N!=="Other"&&e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["ðŸ“ ",N,", Chandapura-Anekal Road, Bangalore - 562106"]})]}),N==="Other"?e.jsx(us,{placeholder:"Enter full address",value:R,onChange:s=>V(s.target.value),className:"min-h-[80px]"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-xs",children:"Block/Tower"}),e.jsx(le,{placeholder:"e.g. 51",value:P,onChange:s=>ue(s.target.value),className:"mt-1 h-9"})]}),e.jsxs("div",{children:[e.jsx(z,{className:"text-xs",children:"Room No."}),e.jsx(le,{placeholder:"e.g. 603",value:A,onChange:s=>xe(s.target.value),className:"mt-1 h-9"})]})]}),N&&(P||A)&&e.jsxs("div",{className:"p-2 bg-muted/50 rounded-lg text-xs",children:[e.jsx("p",{className:"font-medium",children:"Delivery to:"}),e.jsxs("p",{className:"text-muted-foreground",children:[P&&`Block ${P}`,A&&`, Room ${A}`,e.jsx("br",{}),N,", Chandapura-Anekal Road..."]})]})]})]})]})]})]})]}),e.jsx(xs,{children:e.jsx(F,{onClick:Q==="buynow"?He:Xe,className:"w-full h-12",children:Q==="buynow"?e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2"})," Confirm Order â€¢ â‚¹",(m*((a==null?void 0:a.price)||0)).toFixed(0)]}):"Save Address"})})]})}),e.jsx(qe,{})]})}export{As as default};
