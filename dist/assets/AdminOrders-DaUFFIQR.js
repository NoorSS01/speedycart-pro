import{u as S,b as z,r as d,s as A,y as L,j as e,f as h,B as l,A as O,aR as B,S as D,I as E,k as g,m as j,E as F,am as I,q as M,a3 as P,X as R,al as H}from"./index-DxtDyefn.js";import{A as b}from"./AdminBottomNav-DVJ_oCVO.js";import{P as Q}from"./package-check-Br7FxvdL.js";import"./sheet-CSIYxUuD.js";import"./wallet-CpMrejB8.js";function J(){const{user:x,userRole:c,loading:o}=S(),n=z(),[a,v]=d.useState([]),[N,f]=d.useState(!0),[m,y]=d.useState(""),[t,i]=d.useState("all");d.useEffect(()=>{if(!o){if(!x){n("/auth");return}if(c!=="admin"&&c!=="super_admin"){n("/shop");return}k()}},[x,c,o,n]);const k=async()=>{f(!0);const{data:s,error:u}=await A.from("orders").select("*").order("created_at",{ascending:!1}).limit(100);u?L.error("Failed to load orders"):v(s||[]),f(!1)},p=a.filter(s=>{const u=s.id.toLowerCase().includes(m.toLowerCase())||s.delivery_address.toLowerCase().includes(m.toLowerCase()),_=t==="all"||s.status===t;return u&&_}),r={total:a.length,pending:a.filter(s=>s.status==="pending").length,confirmed:a.filter(s=>s.status==="confirmed").length,outForDelivery:a.filter(s=>s.status==="out_for_delivery").length,delivered:a.filter(s=>s.status==="delivered").length,cancelled:a.filter(s=>s.status==="cancelled").length},w=s=>{switch(s){case"delivered":return"bg-emerald-500";case"pending":return"bg-amber-500";case"confirmed":return"bg-blue-500";case"out_for_delivery":return"bg-purple-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},C=s=>{switch(s){case"delivered":return e.jsx(Q,{className:"w-4 h-4"});case"out_for_delivery":return e.jsx(H,{className:"w-4 h-4"});case"cancelled":return e.jsx(R,{className:"w-4 h-4"});default:return e.jsx(P,{className:"w-4 h-4"})}};return o||c===null?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx(h,{className:"h-8 w-48"})})}),e.jsx("main",{className:"container mx-auto px-4 py-6 space-y-4",children:[1,2,3].map(s=>e.jsx(h,{className:"h-24 rounded-xl"},s))}),e.jsx(b,{})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/10 pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/40 backdrop-blur-xl shadow-lg",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>n("/admin"),children:e.jsx(O,{className:"h-5 w-5"})}),e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(B,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"Orders"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.total," total orders"]})]})]})})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-4",children:[e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[e.jsxs(l,{variant:t==="all"?"default":"outline",size:"sm",onClick:()=>i("all"),className:"shrink-0",children:["All (",r.total,")"]}),e.jsxs(l,{variant:t==="pending"?"default":"outline",size:"sm",onClick:()=>i("pending"),className:"shrink-0 border-amber-200",children:["Pending (",r.pending,")"]}),e.jsxs(l,{variant:t==="confirmed"?"default":"outline",size:"sm",onClick:()=>i("confirmed"),className:"shrink-0",children:["Confirmed (",r.confirmed,")"]}),e.jsxs(l,{variant:t==="out_for_delivery"?"default":"outline",size:"sm",onClick:()=>i("out_for_delivery"),className:"shrink-0",children:["Out (",r.outForDelivery,")"]}),e.jsxs(l,{variant:t==="delivered"?"default":"outline",size:"sm",onClick:()=>i("delivered"),className:"shrink-0",children:["Delivered (",r.delivered,")"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(E,{placeholder:"Search by order ID or address...",value:m,onChange:s=>y(s.target.value),className:"pl-9"})]}),N?[1,2,3,4].map(s=>e.jsx(h,{className:"h-24 rounded-xl"},s)):p.length===0?e.jsx(g,{children:e.jsx(j,{className:"p-0",children:e.jsx(F,{type:"orders",title:"No orders found"})})}):p.map(s=>e.jsx(g,{className:`cursor-pointer hover:shadow-md transition-shadow ${s.status==="pending"?"border-amber-200":""}`,onClick:()=>n(`/admin/order/${s.id}`),children:e.jsxs(j,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["#",s.id.slice(0,8)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:I(new Date(s.created_at),"MMM dd, yyyy HH:mm")})]}),e.jsx(M,{className:w(s.status),children:e.jsxs("span",{className:"flex items-center gap-1",children:[C(s.status),s.status.replace(/_/g," ")]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate max-w-[60%]",children:s.delivery_address}),e.jsxs("p",{className:"font-bold text-lg",children:["â‚¹",s.total_amount]})]})]})},s.id))]}),e.jsx(b,{})]})}export{J as default};
